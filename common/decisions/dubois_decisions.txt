####################
# Dubois DECISIONS #
####################

#by Marco Dandolo & Lord R

######################

######HIDE & SHOW DECISIONS######

dubois_hide_animal_decisions = {
	is_shown = {		
		NOT = { 
			has_variable = dubois_hide_animal_decisions_var 
		}
	}

	possible = {
		always = yes
	}

	when_taken = {
		custom_tooltip = {
			text = dubois_hide_animal_decisions_tt
			set_variable = dubois_hide_animal_decisions_var
		} 
	}
	
	ai_chance = {
		base = 0 #AI should never do this
	}
}

dubois_show_animal_decisions = {
	is_shown = {		
		has_variable = dubois_hide_animal_decisions_var
	}

	possible = {
		always = yes
	}

	when_taken = {
		custom_tooltip = {
			text = dubois_show_animal_decisions_tt
			remove_variable = dubois_hide_animal_decisions_var
		} 
	}
	
	ai_chance = {
		base = 10000 #AI should do this only one time
	}
}

#########Zoo##############################################################

#Visit the Zoo
#dubois_visit_zoo_decision = {
#
#	is_shown = {
#		NOT = {
#			has_variable = dubois_hide_animal_decisions_var
#		}
#	}
#
#	possible = {
#		any_scope_building = {
#			is_building_type = building_dubois_zoo
#		}
#		NOT = {
#			has_variable = dubois_visiting_zoo_var #otherwise you could go there millions of times :D
#		}
#	}
#	
#	when_taken = {
#		trigger_event = {
#			id = dubois.1001
#			popup = yes
#		}
#		set_variable = {
#			name = dubois_visiting_zoo_var
#			days = 180
#		}
#		hidden_effect = {
#			if = {
#				limit = {
#					elgar_has_musician = yes
#					has_variable = dubois_zoo_animal_lion
#					has_variable = dubois_zoo_animal_elephant
#					has_variable = dubois_zoo_animal_turtle
#					has_variable = dubois_zoo_animal_kangaroo
#					NOT = {
#						has_variable = dubois_animal_carnival_var
#					}
#				}
#				trigger_event = {
#					id = dubois.1000
#				}
#			}
#		}
#	}
#
#	ai_chance = {
#		base = -1
#	}
#}

#########Zoo Extension##############################################################

dubois_extend_zoo_small_decision = {

	is_shown = {
		any_scope_state = {
			is_capital = yes
			is_production_method_active = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_1
			}
		}
		NOT = {
			has_variable = dubois_zoo_first_extension
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		custom_tooltip = {
			text = dubois_needs_10_animals_tt
			var:dubois_zoo_animal_total >= 10
		}
		OR = {
			custom_tooltip = {
				text = dubois_needs_2_african_animals_tt
				var:dubois_zoo_animal_africa >= 2
			}
			custom_tooltip = {
				text = dubois_needs_2_asian_animals_tt
				var:dubois_zoo_animal_asia >= 2
			}
			custom_tooltip = {
				text = dubois_needs_2_australian_animals_tt
				var:dubois_zoo_animal_australia >= 2
			}
		}
		NOT = {
			has_modifier = dubois_zoo_extension_modifier
		}
	}
	
	when_taken = {
		set_variable = dubois_zoo_first_extension
		random_scope_state = {
			limit = {
				has_building = building_dubois_zoo
				is_capital = yes
			}
			activate_production_method = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_2
			}
		}
		add_modifier = {
			name = dubois_zoo_extension_modifier
			days = 300
		}
	}

	ai_chance = {
		base = 1000
	}
}

dubois_extend_zoo_medium_decision = {

	is_shown = {
		any_scope_state = {
			is_capital = yes
			is_production_method_active = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_2
			}
		}
		NOT = {
			has_variable = dubois_zoo_second_extension
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		custom_tooltip = {
			text = dubois_needs_20_animals_tt
			var:dubois_zoo_animal_total >= 20
		}
		OR = {
			custom_tooltip = {
				text = dubois_needs_5_african_animals_tt
				var:dubois_zoo_animal_africa >= 5
			}
			custom_tooltip = {
				text = dubois_needs_5_asian_animals_tt
				var:dubois_zoo_animal_asia >= 5
			}
			custom_tooltip = {
				text = dubois_needs_5_australian_animals_tt
				var:dubois_zoo_animal_australia >= 5
			}
			custom_tooltip = {
				text = dubois_needs_5_south_american_animals_tt
				var:dubois_zoo_animal_australia >= 5
			}
		}
		NOT = {
			has_modifier = dubois_zoo_extension_modifier
		}
	}
	
	when_taken = {
		set_variable = dubois_zoo_second_extension
		random_scope_state = {
			limit = {
				has_building = building_dubois_zoo
				is_capital = yes
			}
			activate_production_method = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_3
			}
		}
		add_modifier = {
			name = dubois_zoo_extension_modifier
			days = 400
		}
	}

	ai_chance = {
		base = 1000
	}
}

dubois_extend_zoo_large_decision = {

	is_shown = {
		any_scope_state = {
			is_capital = yes
			is_production_method_active = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_3
			}
		}
		NOT = {
			has_variable = dubois_zoo_third_extension
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		custom_tooltip = {
			text = dubois_needs_30_animals_tt
			var:dubois_zoo_animal_total >= 30
		}
		NOT = {
			has_modifier = dubois_zoo_extension_modifier
		}
	}
	
	when_taken = {
		set_variable = dubois_zoo_third_extension
		random_scope_state = {
			limit = {
				has_building = building_dubois_zoo
				is_capital = yes
			}
			activate_production_method = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_4
			}
		}
		add_modifier = {
			name = dubois_zoo_extension_modifier
			days = 500
		}
	}

	ai_chance = {
		base = 1000
	}
}

dubois_extend_zoo_famous_decision = {

	is_shown = {
		any_scope_state = {
			is_capital = yes
			is_production_method_active = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_4
			}
		}
		NOT = {
			has_variable = dubois_zoo_fourth_extension
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		custom_tooltip = {
			text = dubois_needs_40_animals_tt
			var:dubois_zoo_animal_total >= 40
		}
		NOT = {
			has_modifier = dubois_zoo_extension_modifier
		}
	}
	
	when_taken = {
		set_variable = dubois_zoo_fourth_extension
		random_scope_state = {
			limit = {
				has_building = building_dubois_zoo
				is_capital = yes
			}
			activate_production_method = {
				building_type = building_dubois_zoo
				production_method = pm_zoo_level_5
			}
		}
		add_modifier = {
			name = dubois_zoo_extension_modifier
			days = 600
		}
	}

	ai_chance = {
		base = 1000
	}
}

#########Zoo: Catch local animals##############################################################

dubois_catch_local_animal_decision = {

	is_shown = {
		has_technology_researched = dubois_theory_of_evolution_tech
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		dubois_has_naturalist = yes
		custom_tooltip = {
			text = dubois_has_local_animal_tt
			dubois_has_local_animal = yes
		}
		NOT = {
			has_modifier = dubois_search_local_animal_modifier
		}
	}
	
	when_taken = {
		add_modifier = {
			name = dubois_search_local_animal_modifier
		}
		hidden_effect = {
			dubois_set_catch_animals = yes
			random_scope_character = {
				limit = {
					has_trait = dubois_naturalist
					is_busy = no
				}
				add_modifier = {
					name = dubois_animal_hunter_modifier
				}
				set_character_busy = yes
			}
			trigger_event = {
				id = dubois.21
				days = 365
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

#########Zoo: Safari ##############################################################

dubois_safari_decision = {

	is_shown = {
		has_technology_researched = dubois_theory_of_evolution_tech
		NOT = {
			has_modifier = dubois_had_safari_modifier
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		has_technology_researched = civilizing_mission
		any_scope_state = {
			is_capital = yes
			OR = {
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_2
				}
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_3
				}
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_4
				}
			}
		}
		dubois_has_naturalist = yes
		custom_tooltip = {
			text = dubois_safari_possible_tt
			dubois_safari_possible = yes
		}
		NOT = {
			has_modifier = dubois_on_safari_modifier
		}
	}
	
	when_taken = {
		add_modifier = {
			name = dubois_on_safari_modifier
		}
		trigger_event = {
			id = dubois.31
			popup = yes
		}
		hidden_effect = {
			random_scope_character = {
				limit = {
					has_trait = dubois_naturalist
					is_busy = no
				}
				add_modifier = {
					name = dubois_animal_hunter_modifier
				}
				set_character_busy = yes
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

#########Animal Export##############################################################

dubois_ban_animal_export_decision = {

	is_shown = {
		is_player = yes
		dubois_has_habitat = yes
		NOT = {
			has_modifier = dubois_no_animal_export_modifier
		}
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		any_country = {
			has_technology_researched = dubois_theory_of_evolution_tech 
		}
	}
	
	when_taken = {
		add_modifier = {
			name = dubois_no_animal_export_modifier
		}
	}

	ai_chance = {
		base = -1
	}
}

dubois_allow_animal_export_decision = {

	is_shown = {
		is_player = yes
		has_modifier = dubois_no_animal_export_modifier
		NOT = {
			has_variable = dubois_hide_animal_decisions_var
		}
	}

	possible = {
		any_country = {
			has_technology_researched = dubois_theory_of_evolution_tech 
		}
	}
	
	when_taken = {
		remove_modifier = dubois_no_animal_export_modifier
	}

	ai_chance = {
		base = -1
	}
}
