###############################
# DUBOIS DIPLOMATIC ACTIONS  #
###############################

#by Marco Dandolo

############################

#Ask for a zoo animal

ask_for_zoo_animal = {
	requires_approval = yes
	show_effect_in_tooltip = yes

	unlocking_technologies = {
	}

	potential = {
		NOT = { is_country_type = decentralized }
		scope:target_country = {
			NOT = { is_country_type = decentralized }
		}
		scope:target_country = {
			NOT = { 
				has_modifier = dubois_no_animal_export_modifier
			}
		}
		NOT = { has_war_with = scope:target_country }
		is_revolutionary = no
		has_diplomatic_relevance = scope:target_country
		NOT = {
			has_variable = dubois_diplo_action_active
		}
		hidden_trigger = {
			OR = {
				is_player = yes
				AND = {
					is_player = no
					gold_reserves > 100000
				}
			}
		}
	}
	
	possible = {
		NOT = {
			has_modifier = dubois_zoo_transport_modifier
		}
		OR = {
			######NORTH AMERICA######

			#Grizzly Bear
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_grizzly
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_grizzly_habitat_modifier
					}
				}
			}
			#Bald Eagle
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_eagle
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_eagle_habitat_modifier
					}
				}
			}
			#Bison
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_bison
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_bison_habitat_modifier
					}
				}
			}
			#Florida Panther
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_panther
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_panther_habitat_modifier
					}
				}
			}
			######SOUTH AMERICA######

			#Brown-throated sloth
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_sloth
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_sloth_habitat_modifier
					}
				}
			}
			#Jaguar
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_jaguar
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_jaguar_habitat_modifier
					}
				}
			}
			#Giant Anteater
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_anteater
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_anteater_habitat_modifier
					}
				}
			}
			#Nine-banded Armadillo
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_armadillo
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_armadillo_habitat_modifier
					}
				}
			}
			#Andean Condor
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_condor
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_condor_habitat_modifier
					}
				}
			}
			######EUROPE######

			#Iberian lynx
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_lynx
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_lynx_habitat_modifier
					}
				}
			}

			#Eurasian wolf
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_wolf
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_wolf_habitat_modifier
					}
				}
			}

			#Eurasian badger
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_badger
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_badger_habitat_modifier
					}
				}
			}

			#Stoat
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_stoat
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_stoat_habitat_modifier
					}
				}
			}

			#Eurasian otter
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_otter
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_otter_habitat_modifier
					}
				}
			}
			######AFRICA######

			#Hippopotamus
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_hippopotamus
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_hippopotamus_habitat_modifier
					}
				}
			}
			#Lion
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_lion
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_lion_habitat_modifier
					}
				}
			}
			#Elephant
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_elephant
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_elephant_habitat_modifier
					}
				}
			}
			#Giraffe
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_giraffe
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_giraffe_habitat_modifier
					}
				}
			}
			#African penguin
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_penguin
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_penguin_habitat_modifier
					}
				}
			}
			######ASIA######

			#Panda
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_panda
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_panda_habitat_modifier
					}
				}
			}
			#Orangutan
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_orangutan
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_orangutan_habitat_modifier
					}
				}
			}
			#Bengal Tiger
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_tiger
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_tiger_habitat_modifier
					}
				}
			}
			#Malayan Tapir
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_tapir
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_tapir_habitat_modifier
					}
				}
			}
			#Komodo dragon
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_dragon
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_dragon_habitat_modifier
					}
				}
			}
			######AUSTRALIA&OCENIA######

			#Green Sea Turtle
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_turtle
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_turtle_habitat_modifier
					}
				}
			}
			#Manta Ray
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_manta
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_manta_habitat_modifier
					}
				}
			}
			#Red Giant Kangaroo
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_kangaroo
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_kangaroo_habitat_modifier
					}
				}
			}
			#Koala
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_koala
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_koala_habitat_modifier
					}
				}
			}
			#Platypus
			AND = {
				NOT = {
					has_variable = dubois_zoo_animal_platypus
				}
				scope:target_country = {
					any_scope_state = {
						has_modifier = dubois_platypus_habitat_modifier
					}
				}
			}
		}
	}

	accept_effect = {
		set_variable = dubois_diplo_action_active
		add_treasury = -50000
		scope:target_country = {
			add_treasury = 50000
		}
		ROOT = {
			trigger_event = {
				id = dubois.11
				popup = yes
			}
		}
	}
	
	ai = {

		propose_score = {
			value = 100
		}
	
		will_propose = {					
		}

		accept_score = {
			value = -20
			add = {
				desc = "DIPLOMATIC_ACCEPTANCE_BASE"
				value = 5
			}
			add = {
				desc = "DIPLOMATIC_ACCEPTANCE_RELATIONS"			
				if = {
					limit = {
						"relations(scope:actor)" < relations_threshold:cordial
					}
					value = 0
				}
				if = {
					limit = {
						"relations(scope:actor)" >= relations_threshold:cordial
						"relations(scope:actor)" < relations_threshold:amicable
					}
					value = 25
				}	
				if = {
					limit = {
						"relations(scope:actor)" >= relations_threshold:amicable
						"relations(scope:actor)" < relations_threshold:friendly
					}
					value = 35
				}	
				if = {
					limit = {
						"relations(scope:actor)" >= relations_threshold:friendly
					}
					value = 50
				}				
			}
			
			add = {
				desc = "DIPLOMATIC_ACCEPTANCE_INFAMY"
				if = {
					limit = {
						"scope:actor.infamy" >= infamy_threshold:infamous
						"scope:actor.infamy" < infamy_threshold:notorious
					}
					value = -10
				}	
				if = {
					limit = {
						"scope:actor.infamy" >= infamy_threshold:notorious
						"scope:actor.infamy" < infamy_threshold:pariah
					}
					value = -25
				}
				if = {
					limit = {
						"scope:actor.infamy" >= infamy_threshold:pariah
					}
					value = -50
				}					
			}					

			add = {
				desc = "DIPLOMATIC_ACCEPTANCE_RANK"
	
				if = {
					limit = { scope:actor = { country_rank > root.country_rank } }
					value = 20
				}
				
				if = {
					limit = { scope:actor = { country_rank < root.country_rank } }
					value = -10
				}				
			}
			add = {
				desc = "We have a Customs Union"

				if = {
					limit = {
						has_diplomatic_pact = {
							who = scope:actor
							type = customs_union					
						}
					}
					value = 20
				}
			}

			add = {
				desc = "We have a Defensive Pact"

				if = {
					limit = {
						has_diplomatic_pact = {
							who = scope:actor
							type = defensive_pact
						}				
					}
					value = 40
				}	
			}

			add = {
				desc = "We have an Alliance"

				if = {
					limit = {
						has_diplomatic_pact = {
							who = scope:actor
							type = alliance	
						}			
					}
					value = 60
				}
			}

			add = {
				desc = "They are our Subject"

				if = {
					limit = {
						OR = {
							has_diplomatic_pact = {
								who = scope:actor
								type = puppet
							}
							has_diplomatic_pact = {
								who = scope:actor
								type = vassal
							}
							has_diplomatic_pact = {
								who = scope:actor
								type = dominion
							}
							has_diplomatic_pact = {
								who = scope:actor
								type = personal_union
							}
							has_diplomatic_pact = {
								who = scope:actor
								type = tributary
							}
							has_diplomatic_pact = {
								who = scope:actor
								type = protectorate
							}
						}			
					}
					value = 150
				}
			}

			add = {
				desc = "They are not our Subject"

				if = {
					limit = {
						is_subject = yes
						NOT = {
							is_subject_of = scope:actor
						}			
					}
					value = -75
				}
			}

			add = {
				desc = "They are in debt"

				if = {
					limit = {
						scope:target_country = {
							scaled_debt > 0
						}
					}
					value = 300
				}
			}
		}
	}
}
