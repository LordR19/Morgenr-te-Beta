#####################
# DUBOIS ON ACTIONS #
#####################

#by Marco Dandolo

######################

on_building_built = {
	on_actions = {
		dubois_on_building_built
	}
}

on_acquired_technology = {
	on_actions = {
		dubois_on_acquired_technology
	}
}

on_colony_created = {
	on_actions = {
		dubois_on_colony_created
	}
}

on_yearly_pulse_country = { 
	on_actions = {
		dubois_on_yearly_pulse_country
		dubois_on_yearly_pulse_paleontology
		dubois_on_yearly_pulse_botany
		dubois_on_yearly_pulse_random_zoo_babies
		dubois_on_yearly_pulse_habitat_destruction
	}
}

on_monthly_pulse_country = { 
	on_actions = {
		dubois_on_monthly_pulse_country
	}
}

dubois_on_building_built = {
	effect = {
		if = {
			limit = {
				owner = {
					NOT = {
						has_variable = dubois_zoo_inauguration_happened
					}
					dubois_has_zoo = yes
				}
			}
			trigger_event = {
				id = dubois.1 #Dubois 1: Zoo inauguration
				popup = yes
			}
		}
		if = {
			limit = {
				is_building_type = building_university
				level = 1
			}
			state = {
				activate_production_method = {
					building_type = building_university
					production_method = pm_dubois_university_standard
				}
			}
		}
	}
}

dubois_on_acquired_technology = {
	events = {
		dubois.2 #Dubois 2: On the Origin of Species
		dubois.200 #Dubois 200: Opening of the Natural History Museum (Owen)
	}
}

dubois_on_colony_created = {
	effect = {
		if = {
			limit = {
				OR = {
					state_region = s:STATE_LINDI
					state_region = s:STATE_UGANDA
					state_region = s:STATE_KAZEMBE
					state_region = s:STATE_EQUATORIA
					state_region = s:STATE_MOCAMBIQUE
					state_region = s:STATE_KENYA
					state_region = s:STATE_WADDAI
					state_region = s:STATE_BOTSWANA
					state_region = s:STATE_HEREROLAND
					state_region = s:STATE_UBANGI_SHARI
					state_region = s:STATE_CONGO
					state_region = s:STATE_GABON
					state_region = s:STATE_EAST_ANGOLA
					state_region = s:STATE_ZAMBIA
					state_region = s:STATE_VOLTA
					state_region = s:STATE_RIFT_VALLEY
					state_region = s:STATE_NAMAQUALAND
					state_region = s:STATE_TRANSVAAL
					state_region = s:STATE_NORTHERN_CAPE
					state_region = s:STATE_TANGANYIKA
					state_region = s:STATE_VRYSTAAT
					state_region = s:STATE_ZULULAND 
					state_region = s:STATE_AMHARA
					state_region = s:STATE_WEST_MICRONESIA
					state_region = s:STATE_EAST_MICRONESIA
					state_region = s:STATE_NAURU
					state_region = s:STATE_TONGA
					state_region = s:STATE_FIJI
					state_region = s:STATE_WESTERN_NEW_GUINEA
					state_region = s:STATE_EASTERN_NEW_GUINEA
					state_region = s:STATE_SOUTH_ISLAND
				}
			}
			dubois_add_colonial_animal_habitats = yes
		}
	}
}

dubois_on_yearly_pulse_country = {
	events = {
		dubois.3 #Dubois 2: Return of the Beagle
		dubois.4 #Dubois 4: Kosmos
		dubois.5 #Dubois 5: Mendel's Heritage
		dubois.6 #Dubois 6: Dubois finds the Java Man

		dubois.81 #Dubois 81: Yearly paleontological report
		dubois.82 #Dubois 82: Yearly botanical report

		dubois.1250 #Dubois 1250: Yosemite National Park
		dubois.1251 #Dubois 1251: The last Wisents
		dubois.1252 #Dubois 1252: A Royal Hunting Reserve in Gran Paradiso?
		delay = { days = { 30 90 } }
	}
	effect = {
		if = { #This effect removes the Nature Reserve Location Modifier if there is a Nature Reserve built there
			limit = {
				any_scope_state = {
					has_modifier = dubois_nature_reserve_location_modifier
					any_scope_building = {
						is_building_type = building_dubois_national_park
						level > 0
					}
				}
			}
			every_scope_state = {
				limit = {
					has_modifier = dubois_nature_reserve_location_modifier
					any_scope_building = {
						is_building_type = building_dubois_national_park
						level > 0
					}
				}
				remove_modifier = dubois_nature_reserve_location_modifier
			}
		}
	}
}

dubois_on_yearly_pulse_paleontology = {
	random_events = {
		1000 = 0

		#Random Formation Events
		30 = dubois.202 #Dubois 202: Shark Tooth
		20 = dubois.203 #Dubois 203: Dinosaur Footprints
		20 = dubois.204 #Dubois 204: Palaeosinopa
		20 = dubois.205 #Dubois 205: Bones in the mineshaft
		15 = dubois.206 #Dubois 206: Composita
		15 = dubois.207 #Dubois 207: Trilobite
		15 = dubois.208 #Dubois 208: Ammonites
		30 = dubois.209 #Dubois 209: Farns
		5 = dubois.210 #Dubois 210: Dinosauria Eggs
		5 = dubois.211 #Dubois 211: Dinosaur Excavation

		#Special Fossils

		10 = dubois.221 #Dubois 221: Eusthenopteron
		10 = dubois.222 #Dubois 222: Archaeopteryx
		10 = dubois.223 #Dubois 223: Megatherium
		10 = dubois.224 #Dubois 224: Ichthyosaurus
		10 = dubois.225 #Dubois 225: Smilodon
		10 = dubois.226 #Dubois 226: Pterodactylus

		delay = { days = { 15 70 } }
	}
}

dubois_on_yearly_pulse_botany = {
	random_events = {
		1000 = 0

		#Random Botanical Events
		10 = dubois.302 #Dubois 302: Victoria amazonica (Amazonia)
		10 = dubois.303 #Dubois 303: Attacus atlas (Indochina)
		10 = dubois.304 #Dubois 304: Amorphophallus titanum (Borneo)
		10 = dubois.305 #dubois 305: Goliathus (Congo)
		30 = dubois.306 #Dubois 306: New species of orchids
		30 = dubois.307 #Dubois 307: Medicinal plants
		30 = dubois.308 #Dubois 308: Beautiful, poisonous flowers
		30 = dubois.309 #Dubois 309: IG questions botanical expedition
		30 = dubois.311 #Dubois 311: Exotic Seeds

		delay = { days = { 15 70 } }
	}
}

dubois_on_yearly_pulse_random_zoo_babies = {
	random_events = {
		9 = 0

		#Zoo Baby Event
		1 = dubois.1101 #A Baby animal was born
		delay = { days = { 1 360 } }
	}
}

dubois_on_yearly_pulse_habitat_destruction = {
	effect = {
		every_scope_state = {
			limit = {
				dubois_habitat_endangered_for_state = yes
				NOT = {
					has_modifier = dubois_habitat_endangered_modifier
				}
			}
			trigger_event = dubois.1210 #Dubois 1210: [Scope Animal] in [Scope State] is endangered
		}
		every_scope_state = {
			limit = {
				has_modifier = dubois_habitat_endangered_modifier
				NOT = {
					has_modifier = dubois_habitat_endangered_timer_modifier
				}
			}
			trigger_event = dubois.1211 #Dubois 1210: [Scope Animal] in [Scope State] is endangered
		}
	}
}

dubois_on_monthly_pulse_country = {
	events = {
		dubois.71 #Dubois 71: Add Formations
		dubois.72 #Dubois 72: Normal Formation discovered
		dubois.73 #Dubois 73: Great Formation discovered
	}
}
