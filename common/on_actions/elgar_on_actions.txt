####################
# ELGAR ON ACTIONS #
####################

#by Marco Dandolo

######################

on_yearly_pulse_country = { 
	on_actions = {
		elgar_on_yearly_pulse_country
		delay = { days = { 45 330 } }
	}
}

on_acquired_technology = {
	on_actions = {
		elgar_on_acquired_technology
	}
}

on_law_activated = {
	on_actions = {
		elgar_on_law_activated
	}
}

elgar_on_yearly_pulse_country = {

	events = {
		elgar.1 #Elgar 1: Yearly music tradition
		elgar.2 #Elgar 2: Yearly modifier control

		elgar.6 #Elgar 6: Impressionism spreads
		elgar.7 #Elgar 7: Expressionism spreads
		elgar.8 #Elgar 8: Art Nouveau spreads

		elgar.92 #Elgar 92: Gran Teatro Nacional
		elgar.93 #Elgar 93: Teatro Amazonas

		elgar.123 #Elgar 123: Location of the next Tonkünstler-Versammlung


		#Historical
		elgar.501 #Elgar 501: Canto degli Italiani [1847] +10
		elgar.503 #Elgar 503: Deutschlandlied +10
		elgar.504 #Elgar 504: Paganini's death [Genoa, 1840] +50
		elgar.505 #Elgar 505: Verdi, Nabucco [ITA/AUS, 1842] +50
		elgar.507 #Elgar 507: Verdi, Aida [ITA/EGY, 1871] +50
		elgar.509 #Elgar 509: Schubert, Fifth Symphony [Wien, 1841] +50
		elgar.510 #Elgar 510: Poliuto, 1838 [Sicily may keep Donizetti. AI won't do this]
		elgar.511 #Elgar 511: Les Martyres, 1840
		elgar.512 #Elgar 512: Stabat Mater, 1842
		elgar.513 #Elgar 513: Donizetti's illness, 1845 [will not be cured in 80 % of games]
		elgar.516 #Elgar 516: Thalberg vs. Liszt, 1837
		elgar.517 #Elgar 517: Von der Wiege zum Grabe, 1882
		elgar.518 #Elgar 518: Lohengrin, Weimar 1850
		elgar.519 #Elgar 519: Kunstwerk der Zukunft, Zürich 1849
		elgar.520 #Elgar 520: Tristan, Bavaria 1865
		elgar.521 #Elgar 521: Bayreuth 1876 (historical)
		elgar.523 #Elgar 523: Tannhauser scandal
		elgar.524 #Elgar 524: Holberg Suite, 1884 (AI will get him)
		elgar.525 #Elgar 525: New Lanes, 1853
		elgar.526 #Elgar 526: Gesang der Parzen, 1882
		elgar.527 #Elgar 527: The composing orange plantation owner, 1885
		elgar.528 #Elgar 528: An Austrian in New York, 1908
		elgar.529 #Elgar 529: Skythian Suite, 1916

		#Composer Creation
		elgar.701 #Elgar 701: Hector Berlioz, Grande symphonie funèbre et triomphale, 1840
		elgar.702 #Elgar 702: Franz Liszt, Weimar Kapellmeister, 1852
		elgar.703 #Elgar 703: Richard Wagner, Rienzi, 1842
		elgar.704 #Elgar 704: Edvard Grieg, Piano Concerto in A minor, 1869
		elgar.705 #Elgar 705: Johannes Brahms, Variations on a theme by Haydn, 1873
		elgar.706 #Elgar 706: Mahler's first appearance, 1880
		elgar.707 #Elgar 707: Piano Concerto No. 2 1901
		elgar.708 #Elgar 708: Symphony No. 1 "Classical", 1918
	}

	#Effects applied to Composers in the Void
	effect = {
		if = {
			limit = { #Should only be executed once and not by every country. Global var checks for that.
				NOT = { has_global_variable = elgar_character_death_limiter_global_var }
			}

			#Death Event for Mendelssohn
			# General note: on_yearly_pulse_character, etc. does not affect Void-Characters.
			# Therefore we use effects like these.
			if = {
				limit = {
					year >= 1847
					year < 1850 #Should only check before 1850 so it doesn't have to check the limits multiple times.
					any_character_in_void = { #Does Mendelssohn exist?
						has_template = mr_sax_mendelssohn_bartholdy_felix_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_sax_mendelssohn_bartholdy_felix_character_template
					}
					if = { #If Mendelssohn is a composer of a country, the country gets an event
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_sax_mendelssohn_bartholdy_felix_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.601 #Elgar 601: Mendelssohn Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Chopin
			if = {
				limit = {
					year >= 1849
					year < 1853
					any_character_in_void = {
						has_template = mr_fra_chopin_frederic_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_fra_chopin_frederic_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_fra_chopin_frederic_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.602 #Elgar 602: Chopin Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Rossini
			if = {
				limit = {
					year >= 1868
					year < 1871
					any_character_in_void = {
						has_template = mr_pap_rossini_gioachino_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_pap_rossini_gioachino_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_pap_rossini_gioachino_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.603 #Elgar 603: Rossini Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Czerny
			if = {
				limit = {
					year >= 1857
					year < 1860
					any_character_in_void = {
						has_template = mr_aus_czerny_carl_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_aus_czerny_carl_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_aus_czerny_carl_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.604 #Elgar 604: Czerny Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Nicolai
			if = {
				limit = {
					year >= 1849
					year < 1852
					any_character_in_void = {
						has_template = mr_ger_nicolai_otto_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ger_nicolai_otto_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ger_nicolai_otto_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.605 #Elgar 605: Nicolai Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Mercadante
			if = {
				limit = {
					year >= 1870
					year < 1873
					any_character_in_void = {
						has_template = mr_ita_mercadante_saverio_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ita_mercadante_saverio_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ita_mercadante_saverio_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.606 #Elgar 606: Mercadante Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Pacini
			if = {
				limit = {
					year >= 1867
					year < 1870
					any_character_in_void = {
						has_template = mr_ita_pacini_giovanni_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ita_pacini_giovanni_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ita_pacini_giovanni_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.607 #Elgar 607: Pacini Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Meyerbeer
			if = {
				limit = {
					year >= 1864
					year < 1867
					any_character_in_void = {
						has_template = mr_ger_meyerbeer_giacomo_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ger_meyerbeer_giacomo_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ger_meyerbeer_giacomo_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.608 #Elgar 608: Meyerbeer Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Lachner
			if = {
				limit = {
					year >= 1890
					year < 1893
					any_character_in_void = {
						has_template = mr_bav_lachner_franz_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_bav_lachner_franz_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_bav_lachner_franz_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.609 #Elgar 609: Lachner Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Spohr
			if = {
				limit = {
					year >= 1859
					year < 1862
					any_character_in_void = {
						has_template = mr_hek_spohr_louis_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_hek_spohr_louis_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_hek_spohr_louis_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.610 #Elgar 610: Spohr Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Strauss I
			if = {
				limit = {
					year >= 1849
					year < 1842
					any_character_in_void = {
						has_template = mr_aus_strauss_i_johann_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_aus_strauss_i_johann_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_aus_strauss_i_johann_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.611 #Elgar 611: Strauss I Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Glinka
			if = {
				limit = {
					year >= 1857
					year < 1860
					any_character_in_void = {
						has_template = mr_rus_glinka_mikhail_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_rus_glinka_mikhail_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_rus_glinka_mikhail_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.612 #Elgar 612: Glinka Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Donizetti [natural, a-historical death]
			if = {
				limit = {
					year >= 1868
					year < 1871
					any_character_in_void = {
						has_template = mr_ita_donizetti_gaetano_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ita_donizetti_gaetano_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ita_donizetti_gaetano_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.613 #Elgar 613: Donizetti Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Berlioz
			if = {
				limit = {
					year >= 1869
					year < 1872
					any_character_in_void = {
						has_template = mr_fra_berlioz_hector_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_fra_berlioz_hector_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_fra_berlioz_hector_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.614 #Elgar 614: Berlioz Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Liszt
			if = {
				limit = {
					year >= 1886
					year < 1889
					any_character_in_void = {
						has_template = mr_aus_liszt_franz_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_aus_liszt_franz_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_aus_liszt_franz_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.615 #Elgar 615: Liszt Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Wagner
			if = {
				limit = {
					year >= 1883
					year < 1886
					any_character_in_void = {
						has_template = mr_ger_wagner_richard_composer_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ger_wagner_richard_composer_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ger_wagner_richard_composer_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.616 #Elgar 616: Wagner Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Grieg
			if = {
				limit = {
					year >= 1907
					year < 1910
					any_character_in_void = {
						has_template = mr_nor_grieg_edvard_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_nor_grieg_edvard_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_nor_grieg_edvard_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.617 #Elgar 617: Grieg Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#Death Event for Brahms
			if = {
				limit = {
					year >= 1897
					year < 1900
					any_character_in_void = {
						has_template = mr_ger_brahms_johannes_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_ger_brahms_johannes_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_ger_brahms_johannes_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.618 #Elgar 618: Brahms Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#This is used to keep the effect from getting executed by multiple countries
			set_global_variable = {
				name = elgar_character_death_limiter_global_var
				months = 6
			}

			#Death Event for Mahler
			if = {
				limit = {
					year >= 1911
					year < 1914
					any_character_in_void = {
						has_template = mr_aus_mahler_gustav_character_template
					}
				}
				random_character_in_void = {
					limit = {
						has_template = mr_aus_mahler_gustav_character_template
					}
					if = {
						limit = {
							owner ?= {
								var:elgar_composer_var ?= {
									has_template = mr_aus_mahler_gustav_character_template
								}
							}
						}
						owner = {
							trigger_event = elgar.619 #Elgar 619: Mahler Death
						}
					}
					else = { #Otherwise he just dies.
						kill_character = yes
					}
				}
			}

			#This is used to keep the effect from getting executed by multiple countries
			set_global_variable = {
				name = elgar_character_death_limiter_global_var
				months = 6
			}
		}
	}
}

elgar_on_acquired_technology = {
	events = {
		elgar.3 #Elgar 3: Impressionism
		elgar.4 #Elgar 4: Expressionism
		elgar.5 #Elgar 5: Art Nouveau
		elgar.9 #Elgar 9: Twelve-tone technique
	}
}

elgar_on_law_activated = {
	effect = {
		owner = {
			if = {
				limit = {
					has_modifier = elgar_patron_of_arts_modifier
					NOT = {
						has_law = law_type:law_traditionalism
					}
				}
				remove_modifier = elgar_patron_of_arts_modifier
			}
		}
	}
}

