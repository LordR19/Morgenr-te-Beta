###############################
# MORGENRÖTE SCRIPTED BUTTONS #
###############################

#by Marco Dandolo

######################

######ARCHAEOLOGICAL EXPEDITIONS######

#Upper Egypt/The Valley of the Kings

mr_upper_egypt_expedition_button = {
	name = "mr_upper_egypt_expedition_button"
	desc = "mr_upper_egypt_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_valley_kings_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_upper_egypt_expedition_modifier
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_upper_egypt
			}
			global_var:lepsius_valley_kings_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_upper_egypt_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Lower Egypt/The Pyramids

mr_lower_egypt_expedition_button = {
	name = "mr_lower_egypt_expedition_button"
	desc = "mr_lower_egypt_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_pyramids_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_lower_egypt_expedition_modifier
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_lower_egypt
			}
			global_var:lepsius_pyramids_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_lower_egypt_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#Baghdad/Babylonia

mr_babylonia_expedition_button = {
	name = "mr_babylonia_expedition_button"
	desc = "mr_babylonia_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_babylonia_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_babylonia_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_babylonia
			}
			global_var:lepsius_babylonia_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_babylonia_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Mosul/Assyria

mr_assyria_expedition_button = {
	name = "mr_assyria_expedition_button"
	desc = "mr_assyria_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_assyria_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_assyria_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_early_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_assyria
			}
			global_var:lepsius_assyria_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}	
		add_modifier = {
			name = lepsius_assyria_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#Peloponnes/Argolis

mr_argolis_expedition_button = {
	name = "mr_argolis_expedition_button"
	desc = "mr_argolis_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_argolis_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_argolis_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_early_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_argolis
			}
			global_var:lepsius_argolis_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}	
		add_modifier = {
			name = lepsius_argolis_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Crete

mr_crete_expedition_button = {
	name = "mr_crete_expedition_button"
	desc = "mr_crete_expedition_button_desc"

	visible = { 
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_crete_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_crete_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_crete
			}
			global_var:lepsius_crete_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_crete_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }	
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Yucatán

mr_yucatan_expedition_button = {
	name = "mr_yucatan_expedition_button"
	desc = "mr_yucatan_expedition_button_desc"

	visible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_yucatan_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_yucatan_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_antiquarianism_tech
		has_technology_researched = quinine
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_yucatan
			}
			global_var:lepsius_yucatan_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_yucatan_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#Peru

mr_peru_expedition_button = {
	name = "mr_peru_expedition_button"
	desc = "mr_peru_expedition_button_desc"

	visible = {
		OR = {
			country_rank >= rank_value:major_power
			has_building = building_airport
		}
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		has_global_variable = lepsius_peru_state_region_global_var
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_peru_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		has_technology_researched = military_aviation
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_state_trait = lepsius_state_trait_peru
			}
			global_var:lepsius_peru_state_region_global_var ?= {
				any_scope_state = {
					owner = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}
					}
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_peru_expedition_modifier
		}
		lepsius_set_archaeologist_busy_effect = yes
		trigger_event = { id = lepsius.100 popup = yes }			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#################################

###Inspect and Cancel Excavation###

#Inspect Excavation

mr_inspect_excavation_button = {
	name = "mr_inspect_excavation_button"
	desc = "mr_inspect_excavation_button_desc"

	visible = { 
		lepsius_has_discovery_excavation = yes
		lepsius_on_excavation_inspection = no
		NOT = {
			has_modifier = lepsius_recent_excavation_inspection_modifier
		}
		NOT = {
			has_variable = lepsius_inspect_excavation_decision_on
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_inspect_excavation_tt
			lepsius_has_discovery_excavation = yes
 		}
		custom_tooltip = {
			text = lepsius_has_artifacts_for_discovery_tt
			lepsius_has_artifacts_for_discovery = yes
 		}
		has_technology_researched = lepsius_modern_archaeology_tech
		OR = {
			lepsius_has_active_experienced_archaeologist = yes
			lepsius_has_active_famous_archaeologist = yes
		}
	}

	effect = {
		set_variable = lepsius_inspect_excavation_decision_on
		trigger_event = { 
			id = lepsius.801 
			popup = yes 
		}		
	}

	ai_chance = {
		base = 100
	}
}

#Cancel Excavation

mr_cancel_excavation_button = {
	name = "mr_cancel_excavation_button"
	desc = "mr_cancel_excavation_button_desc"

	visible = { 
		is_player = yes
		lepsius_on_archaeological_excavation = yes
		lepsius_on_excavation_inspection = no
		NOT = {
			has_variable = lepsius_cancel_excavation_decision_on
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_on_archaeological_excavation_tt
			lepsius_on_archaeological_excavation = yes
 		}
	}

	effect = {
		set_variable = lepsius_cancel_excavation_decision_on
		trigger_event = { id = lepsius.190 popup = yes }		
	}

	ai_chance = {
		base = 0
	}
}

#Local Excavation

mr_local_excavation_button = {
	name = "mr_local_excavation_button"
	desc = "mr_local_excavation_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		NOT = {
			has_modifier = lepsius_local_excavation_modifier
		}
	}

	possible = {
		has_technology_researched = lepsius_early_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		lepsius_has_active_archaeologist = yes
	}

	effect = {
		add_treasury = -25000
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		lepsius_set_archaeologist_busy_effect = yes
		hidden_effect = {
			trigger_event = { id = lepsius.1201 popup = yes }			
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				country_rank <= rank_value:major_power
			}
			add = 100
		}
		modifier = {
			trigger = { 
				var:lepsius_local_artifact_minor >= 50
			}
			add = -1000
		}
	}
}

#################################

###Excavation Teams###

#First Team

mr_first_excavation_team_button = {
	name = "mr_first_excavation_team_button"
	desc = "mr_first_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		NOT = {
			has_variable = lepsius_first_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_antiquarianism_tech
		country_has_building_type_levels = {  
			target = bt:building_university  
			value  >= 3
		}
		literacy_rate >= 0.33
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}	
		set_variable = lepsius_first_excavation_team			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
	}
}

#Second Team

mr_second_excavation_team_button = {
	name = "mr_second_excavation_team_button"
	desc = "mr_second_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		has_variable = lepsius_first_excavation_team
		NOT = {
			has_variable = lepsius_second_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_has_experienced_archaeologist = yes
		any_scope_building = {
			is_building_type = building_lepsius_archaeological_museum
		}
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}	
		set_variable = lepsius_second_excavation_team			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#Third Team

mr_third_excavation_team_button = {
	name = "mr_third_excavation_team_button"
	desc = "mr_third_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_modern_archaeology_tech
		has_variable = lepsius_first_excavation_team
		has_variable = lepsius_second_excavation_team
		NOT = {
			has_variable = lepsius_third_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		country_has_building_type_levels = {  
			target = bt:building_university  
			value  >= 15
		}
		literacy_rate >= 0.66
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}		
		set_variable = lepsius_third_excavation_team		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#Fourth Team

mr_fourth_excavation_team_button = {
	name = "mr_fourth_excavation_team_button"
	desc = "mr_fourth_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_modern_archaeology_tech
		has_variable = lepsius_first_excavation_team
		has_variable = lepsius_second_excavation_team
		has_variable = lepsius_third_excavation_team
		NOT = {
			has_variable = lepsius_fourth_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		lepsius_has_famous_archaeologist = yes
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}		
		set_variable = lepsius_fourth_excavation_team		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

###########################################################################

######THE ARTS######

###Painter###

mr_vernissage_button = {
	name = "mr_vernissage_button"
	desc = "mr_vernissage_button_desc"

	visible = { 
		always = yes
	}

	possible = {
		any_scope_state = {
			any_scope_building = {
				has_active_production_method = pm_artists_arts_academy_studio
			}
		}
		klimt_has_active_painter = yes
		klimt_vernissage_possible = yes
	}

	effect = {
		trigger_event = { 
			id = klimt.40
			popup = yes
		}
	}

	ai_chance = {
		base = 100
	}
}

mr_painter_trip_button = {
	name = "mr_painter_trip_button"
	desc = "mr_painter_trip_button_desc"

	visible = { 
		NOT = {
			has_variable = klimt_trip_destination_var
		}
	}

	possible = {
		klimt_has_active_painter = yes
		klimt_painter_trip_possible = yes
	}

	effect = {
		set_variable = klimt_trip_destination_var
		if = {
			limit = {
				klimt_has_active_painter = yes
			}
			trigger_event = { 
				id = klimt.401
				popup = yes
			}
		}
	}

	ai_chance = {
		base = 100
	}
}

###Writer###

mr_newspaper_novel_button = {
	name = "mr_newspaper_novel_button"
	desc = "mr_newspaper_novel_button_desc"

	visible = { 
		always = yes
	}

	possible = {
		has_technology_researched = realism
		any_scope_building = {
			is_building_type = building_manzoni_publishing_industry
			is_under_construction = no
			cash_reserves_ratio > 0.5
			occupancy >= 0.75
		}
		manzoni_has_active_writer = yes
		var:manzoni_writer_var ?= {
			has_trait = manzoni_writer_fiction
		}
		NOT = {
			var:manzoni_writer_var ?= {
				has_variable = manzoni_newspaper_novel_var
			}
		}
		NOT = {
			has_modifier = manzoni_newspaper_novel_scandal_modifier
		}
	}

	effect = {
		var:manzoni_writer_var = {
			set_character_busy_and_immortal = yes
		}
		add_journal_entry = {
			type = pbi_je_objective_bestseller
		}
	}

	ai_chance = {
		base = 100
	}
}

mr_reading_tour_button = {
	name = "mr_reading_tour_button"
	desc = "mr_reading_tour_button_desc"

	visible = { 
		always = yes
	}

	possible = {
		manzoni_has_active_writer = yes
		var:manzoni_writer_var ?= {
			has_trait = manzoni_writer_fiction
			has_trait = manzoni_writer_poet
			has_trait = manzoni_universal_writer
		}
		NOT = {
			var:manzoni_writer_var ?= {
				has_variable = manzoni_reading_tour_var
			}
		}
		any_country = {
			manzoni_foreign_writer_meets_taste_trigger = yes
		}
		NOT = {
			has_modifier = manzoni_writer_on_tour_modifier
		}
	}

	effect = {
		var:manzoni_writer_var = {
			set_character_busy_and_immortal = yes
		}
		add_modifier = {
			name = manzoni_writer_on_tour_modifier
		}
		trigger_event = {
			id = manzoni.331
			popup = yes
		}
	}

	ai_chance = {
		base = 100
	}
}

###Monuments###

mr_mozart_monument_button = {
	name = "mr_mozart_monument_button"
	desc = "mr_mozart_monument_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_TYROL
		}
		is_player = yes
		NOT = {
			has_global_variable = elgar_mozart_monument_var
		}
	}

	possible = {
		is_at_war = no
		any_scope_state = {
			state_region = s:STATE_TYROL
		}
		has_technology_researched = romanticism
		any_scope_building = {
			is_building_type = building_elgar_opera
			level >= 4
		}
				
		custom_tooltip = {
			text = elgar_mozart_monument_decision_tt
			var:elgar_music_tradition >= 50
		}
	}

	effect = {
		trigger_event = { 
			id = elgar.111
			popup = yes
		}
		set_global_variable = elgar_mozart_monument_var		
	}

	ai_chance = {
		base = 1000
	}
}

mr_mozart_monument_ai_button = {
	name = "mr_mozart_monument_button"
	desc = "mr_mozart_monument_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_TYROL
		}
		is_player = no
		NOT = {
			has_global_variable = elgar_mozart_monument_var
		}
	}

	possible = {
		is_at_war = no
		any_scope_state = {
			state_region = s:STATE_TYROL
		}
		has_technology_researched = romanticism
		custom_tooltip = {
			text = elgar_mozart_monument_decision_tt
			var:elgar_music_tradition >= 50
		}
	}

	effect = {
		trigger_event = { 
			id = elgar.111
			popup = yes
		}
		set_global_variable = elgar_mozart_monument_var
	}

	ai_chance = {
		base = 1000
	}
}

mr_beethoven_monument_button = {
	name = "mr_beethoven_monument_button"
	desc = "mr_beethoven_monument_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_NORTH_RHINE
		}
		has_variable = elgar_beethoven_sponsor_var
		NOT = {
			has_global_variable = elgar_beethoven_monument_var
		}
	}

	possible = {
		is_at_war = no
		any_scope_state = {
			state_region = s:STATE_NORTH_RHINE
		}
		has_technology_researched = elgar_irrationalism_tech
		custom_tooltip = {
			text = elgar_beethoven_monument_decision_tt
			var:elgar_music_tradition >= 100
		}
	}

	effect = {
		trigger_event = { 
			id = elgar.102
			popup = yes
		}
		set_global_variable = elgar_beethoven_monument_var
	}

	ai_chance = {
		base = 1000
	}
}

###Allgemeiner Deutscher Musikverein###

mr_musikverein_button = {
	name = "mr_musikverein_button"
	desc = "mr_musikverein_button_desc"

	visible = { 
		OR = {
			country_has_primary_culture = cu:south_german
			country_has_primary_culture = cu:north_german
			country_has_primary_culture = cu:united_german
			country_has_primary_culture = cu:alemannic
			country_has_primary_culture = cu:united_swiss
		}
		NOT = {
			has_global_variable = elgar_musikverein_var
		}
	}

	possible = {
		elgar_has_great_composer = yes
		has_technology_researched = nationalism
		has_technology_researched = elgar_irrationalism_tech
		custom_tooltip = {
			text = elgar_musikverein_decision_tt
			var:elgar_music_tradition >= 250
		}
	}

	effect = {
		add_modifier = {
			name = elgar_founded_musikverein_modifier
		}
		trigger_event = { 
			id = elgar.121
			popup = yes
		}
		set_global_variable = elgar_musikverein_var
	}

	ai_chance = {
		base = 1000
	}
}

###Other special musical institutions###

mr_concertgebouw_button = {
	name = "mr_concertgebouw_button"
	desc = "mr_concertgebouw_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_HOLLAND
		}
		OR = {
			country_has_primary_culture = cu:wallonian
			country_has_primary_culture = cu:flemish
			country_has_primary_culture = cu:dutch
		}
		NOT = {
			any_state = {
				has_modifier = elgar_amsterdam_concertgebouw_modifier
			}
		}
	}

	possible = {
		any_scope_state = {
			state_region = s:STATE_HOLLAND
		}
		any_scope_building = {
			is_building_type = building_elgar_opera
			level >= 10
		}
		custom_tooltip = {
			text = elgar_concertgebouw_decision_tt
			var:elgar_music_tradition >= 750
		}
	}

	effect = {
		every_state = {
			limit = {
				state_region = s:STATE_HOLLAND
			}
			add_modifier = {
				name = elgar_amsterdam_concertgebouw_modifier
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

mr_the_proms_button = {
	name = "mr_the_proms_button"
	desc = "mr_the_proms_button_desc"

	visible = { 
		any_scope_state = {
			state_region = s:STATE_HOME_COUNTIES
		}
		c:GBR ?= this
		NOT = {
			any_state = {
				has_modifier = elgar_london_proms_modifier
			}
		}
	}

	possible = {
		any_scope_state = {
			state_region = s:STATE_HOME_COUNTIES
		}
		any_scope_building = {
			is_building_type = building_elgar_opera
			level >= 20
		}
		custom_tooltip = {
			text = elgar_the_proms_decision_tt
			var:elgar_music_tradition >= 750
		}
	}

	effect = {
		every_state = {
			limit = {
				state_region = s:STATE_HOME_COUNTIES
			}
			add_modifier = {
				name = elgar_london_proms_modifier
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

###National Broadcasting Channel###

mr_nbc_button = {
	name = "mr_nbc_button"
	desc = "mr_nbc_button_desc"

	visible = { 
		NOT = {
			has_variable = elgar_nbc_var
		}
	}

	possible = {
		has_technology_researched = radio
		has_technology_researched = elgar_mass_culture_tech
		any_scope_state = {
			any_scope_building = {
				is_building_type = building_railway
				has_active_production_method = pm_elgar_radio_stations
			}
			percent >= 0.35
		}
		NOR = {
			has_law = law_type:law_laissez_faire
			has_law = law_type:law_anarchy
		}
	}

	effect = {
		set_variable = elgar_nbc_var
		trigger_event = {
			id = elgar.40
			popup = yes
		}
	}

	ai_chance = {
		base = 1000
	}
}

mr_nbc_license_button = {
	name = "mr_nbc_license_button"
	desc = "mr_nbc_button_desc"

	visible = { 
		has_technology_researched = radio
		has_variable = elgar_nbc_var
		NOR = {
			has_modifier = elgar_nbc_news_modifier
			has_modifier = elgar_nbc_education_modifier
			has_modifier = elgar_nbc_government_modifier
			has_modifier = elgar_nbc_monarch_modifier
			has_modifier = elgar_nbc_propaganda_modifier
		}
		NOR = {
			has_law = law_type:law_laissez_faire
			has_law = law_type:law_anarchy
		}
		NOT = {
			has_variable = elgar_nbc_decision_taken
		}
	}

	possible = {
		has_technology_researched = radio
		has_technology_researched = political_agitation
		has_technology_researched = elgar_mass_culture_tech
		any_scope_building = {
			is_building_type = building_urban_center
			has_active_production_method = pm_elgar_radio_stations
		}
	}

	effect = {
		trigger_event = {
			id = elgar.40
			popup = yes
		}
		set_variable = elgar_nbc_decision_taken
	}

	ai_chance = {
		base = 1000
	}
}
