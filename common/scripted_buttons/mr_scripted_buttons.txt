###############################
# MORGENRÖTE SCRIPTED BUTTONS #
###############################

#by Marco Dandolo

######################

######ARCHAEOLOGICAL MUSEUM######

mr_visit_museum_button = {
	name = "mr_visit_museum_button"
	desc = "mr_visit_museum_button_desc"

	visible = { always = yes }

	possible = {
		any_scope_building = {
			is_building_type = building_lepsius_archaeological_museum
			level >= 1
		}
		custom_tooltip = {
			text = mr_visiting_museum_tt
			NOT = {
				has_variable = lepsius_visiting_museum_var
			}
		}
	}

	effect = {
		set_variable = lepsius_visiting_museum_var
		trigger_event = { 
			id = lepsius.11 
			popup = yes 
		}
	}
}

######OBSERVATORY######

mr_visit_observatory_button = {
	name = "mr_visit_observatory_button"
	desc = "mr_visit_observatory_button_desc"

	visible = { always = yes }

	possible = {
		any_scope_building = {
			is_building_type = building_verrier_observatory
			level >= 1
		}
		custom_tooltip = {
			text = verrier_visiting_observatory_tt
			NOT = {
				has_variable = verrier_visiting_observatory_var
			}
		}
	}

	effect = {
		set_variable = verrier_visiting_observatory_var
		trigger_event = { 
			id = verrier.100 
			popup = yes 
		}
	}
}

######OPERA######

mr_visit_opera_button = {
	name = "mr_visit_opera_button"
	desc = "mr_visit_opera_button_desc"

	visible = { always = yes }

	possible = {
		any_scope_building = {
			is_building_type = building_elgar_opera
			level >= 1
		}
		custom_tooltip = {
			text = mr_visiting_opera_tt
			NOT = {
				has_variable = elgar_visiting_opera_var
			}
		}
	}

	effect = {
		set_variable = elgar_visiting_opera_var
		trigger_event = { 
			id = elgar.10
			popup = yes 
		}
	}
}

######ZOO######

mr_visit_zoo_button = {
	name = "mr_visit_zoo_button"
	desc = "mr_visit_zoo_button_desc"

	visible = { always = yes }

	possible = {
		any_scope_building = {
			is_building_type = building_dubois_zoo
			level >= 1
		}
		custom_tooltip = {
			text = mr_visiting_zoo_tt
			NOT = {
				has_variable = dubois_visiting_zoo_var
			}
		}
	}

	effect = {
		set_variable = dubois_visiting_zoo_var
		trigger_event = {
			id = dubois.1001
			popup = yes
		}
		hidden_effect = {
			if = {
				limit = {
					elgar_has_musician = yes
					has_variable = dubois_zoo_animal_lion
					has_variable = dubois_zoo_animal_elephant
					has_variable = dubois_zoo_animal_turtle
					has_variable = dubois_zoo_animal_kangaroo
					NOT = {
						has_variable = dubois_animal_carnival_var
					}
				}
				trigger_event = {
					id = dubois.1000
				}
			}
		}
	}
}

######PALEONTOLOGICAL COLLECTION######

mr_visit_paleontological_collection_button = {
	name = "mr_visit_paleontological_collection_button"
	desc = "mr_visit_paleontological_collection_button_desc"

	visible = { always = yes }

	possible = {
		OR = {
			dubois_has_paleontologist = yes
			dubois_has_fossil = yes
			dubois_has_dinosaur_bone = yes
		}
		custom_tooltip = {
			text = mr_visiting_fossils_tt
			NOT = {
				has_variable = dubois_visiting_fossils_var
			}
		}
	}

	effect = {
		set_variable = dubois_visiting_fossils_var
		trigger_event = {
			id = dubois.2001
			popup = yes
		}
	}
}

######SCIENTIFIC SOCIETY######

mr_visit_scientific_society_button = {
	name = "mr_visit_scientific_society_button"
	desc = "mr_visit_scientific_society_button_desc"

	visible = { always = yes }

	possible = {
		OR ={
			gaudi_has_engineer = yes
			verrier_has_astronomer = yes
			dubois_has_naturalist = yes
			dubois_has_paleontologist = yes
			lepsius_has_archaeologist = yes
			lepsius_has_anthropologist = yes
		}
		custom_tooltip = {
			text = mr_visiting_scientific_society_tt
			NOT = {
				has_variable = academics_character_overview_var
			}
		}
	}

	effect = {
		set_variable = academics_character_overview_var
		trigger_event = {
			id = academics.30
			popup = yes
		}
	}
}

###########################################################################

#SCIENTIFIC EXPEDITION

######PACIFIC EXPEDITION######

mr_pacific_expedition_button = {
	name = "mr_pacific_expedition_button"
	desc = "mr_pacific_expedition_button_desc"

	visible = { always = yes }

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = screw_frigate
		has_technology_researched = dialectics
		any_scope_building = {
			is_building_type = building_port
		}
		any_scope_building = {
			is_building_type = building_university
		}
		navy_size >= 15
		any_scope_character = {
			has_role = admiral
			is_busy = no
		}
		NOT = {
			any_country = {
				OR = {
					has_technology_researched = dreadnought
					has_technology_researched = destroyer
				}
			}
		}
		NOR = {
			has_modifier = rapanui_pacific_expedition_modifier
			has_modifier = rapanui_had_pacific_expedition_modifier
		}
	}

	effect = {
		add_treasury = -25000
		add_modifier = {
			name = rapanui_pacific_expedition_modifier
		}
		trigger_event = { 
			id = rapanui.201
			popup = yes 
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
	}
}

######MOUNTAIN EXPEDITION######

mr_mountain_expedition_button = {
	name = "mr_mountain_expedition_button"
	desc = "mr_mountain_expedition_button_desc"

	visible = { always = yes }

	possible = {
		dubois_has_unconquered_summit = yes
		has_technology_researched = prospecting
		has_technology_researched = nationalism
		any_scope_character = {
			has_role = general
			is_busy = no
			OR = {
				has_trait = dubois_mountaineer
				has_trait = explorer
				has_trait = mountain_commander
				has_trait = surveyor
			}
		}
		NOR = {
			has_modifier = dubois_summit_level_1_modifier
			has_modifier = dubois_summit_level_2_modifier
			has_modifier = dubois_summit_level_3_modifier
			has_modifier = dubois_summit_level_4_modifier
			has_modifier = dubois_mountaineering_disaster_modifier
			has_modifier = dubois_mountaineering_disappointment_modifier
		}
	}

	effect = {
		add_treasury = -25000
		trigger_event = { 
			id = dubois.411
			popup = yes 
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = {
				gold_reserves > 0
			}
			add = 100
		}
	}
}

######ARCTIC EXPEDITION######

mr_arctica_expedition_button = {
	name = "mr_arctica_expedition_button"
	desc = "mr_arctica_expedition_button_desc"

	visible = { always = yes }

	possible = {
		has_technology_researched = zeppelins
		any_scope_building = {
			is_building_type = building_verrier_observatory
			has_active_production_method = pm_curtiss_weather_station
		}
		any_scope_character = {
			OR = {
				has_trait = curtiss_pilot
				has_trait = curtiss_pilot_ace
			}
			is_busy = no
		}
		OR = {

			OR = {
				any_scope_state = {
					state_region = s:STATE_GREENLAND
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_GREENLAND
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_NORTHERN_NORWAY
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_NORTHERN_NORWAY
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_ALASKA
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_ALASKA
					}
				}		
			}
			OR = {
				any_scope_state = {
				state_region = s:STATE_NUNAVUT
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_NUNAVUT
					}
				}		
			}
			OR = {
				any_scope_state = {
					state_region = s:STATE_NENETSIA
				}
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = airspace_convention
					}				
					any_scope_state = {
						state_region = s:STATE_NENETSIA
					}
				}		
			}
		}
		NOR = {
			has_modifier = curtiss_arctica_expedition_modifier
			has_modifier = curtiss_had_arctica_expedition_modifier
		}
	}

	effect = {
		set_variable = {
			name = curtiss_zeppelin_progress
			value = 0
		}
		set_variable = {
			name = curtiss_zeppelin_science
			value = 0
		}
		set_variable = {
			name = curtiss_zeppelin_danger
			value = 0
		}
		add_modifier = {
			name = curtiss_arctica_expedition_modifier
		}
		add_modifier = {
			name = curtiss_zeppelin_expedition_cost_modifier
			multiplier = money_amount_multiplier_small
		}
		trigger_event = { 
			id = curtiss.520
			popup = yes 
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_small
				gold_reserves > 0

			}
			add = 1
		}
		modifier = {
			trigger = {
				has_strategy = ai_strategy_armed_isolationism
			}
			add = -1000
		}		
		modifier = {
			OR = {
				is_diplomatic_play_committed_participant = yes
				is_at_war = yes
			}
			add = -1000
		}
	}
}

######SAFARI EXPEDITION######

mr_safari_expedition_button = {
	name = "mr_safari_expedition_button"
	desc = "mr_safari_expedition_button_desc"

	visible = { always = yes }

	possible = {
		has_technology_researched = dubois_theory_of_evolution_tech
		has_technology_researched = civilizing_mission
		any_scope_state = {
			is_capital = yes
			OR = {
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_2
				}
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_3
				}
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_zoo_level_4
				}
			}
		}
		dubois_has_active_naturalist = yes
		custom_tooltip = {
			text = dubois_safari_possible_tt
			dubois_safari_possible = yes
		}
		NOR = {
			has_modifier = dubois_on_safari_modifier
			has_modifier = dubois_had_safari_modifier
		}
	}

	effect = {
		add_modifier = {
			name = dubois_on_safari_modifier
		}
		trigger_event = {
			id = dubois.31
			popup = yes
		}
		hidden_effect = {
			var:dubois_naturalist_var = {
				add_modifier = {
					name = dubois_animal_hunter_modifier
				}
				set_character_busy = yes
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

######ZOOLOGICAL EXPEDITION

mr_zoological_expedition_button = {
	name = "mr_zoological_expedition_button"
	desc = "mr_zoological_expedition_button_desc"

	visible = { always = yes }

	possible = {
		has_technology_researched = dubois_theory_of_evolution_tech
		dubois_has_active_naturalist = yes
		custom_tooltip = {
			text = dubois_has_local_animal_tt
			dubois_has_local_animal = yes
		}
		NOT = {
			has_modifier = dubois_search_local_animal_modifier
		}
	}

	effect = {
		add_modifier = {
			name = dubois_search_local_animal_modifier
		}
		hidden_effect = {
			dubois_set_catch_animals = yes
			var:dubois_naturalist_var = {
				add_modifier = {
					name = dubois_animal_hunter_modifier
				}
				set_character_busy = yes
			}
			trigger_event = {
				id = dubois.21
				days = 365
			}
		}
	}

	ai_chance = {
		base = 1000
	}
}

######BOTANICAL EXPEDITION######

mr_botanical_expedition_button = {
	name = "mr_botanical_expedition_button"
	desc = "mr_botanical_expedition_button_desc"

	visible = {
		NOT = {
			has_modifier = dubois_botanical_expedition_modifier
		}
	}

	possible = {
		has_technology_researched = dubois_theory_of_evolution_tech
		has_technology_researched = malaria_prevention
		dubois_has_active_naturalist = yes
		dubois_botanical_expedition_banned = no
		OR = {
			dubois_has_rainforest = yes
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = botanical_license
				}				
				dubois_has_rainforest = yes
			}
		}
	}

	effect = {
		trigger_event = { 
			id = dubois.301
			popup = yes 
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:dubois_specimen < 35000
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 45000
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:dubois_specimen >= 50000
			}
			add = -200
		}	
	}
}

mr_botanical_expedition_recall_button = {
	name = "mr_botanical_expedition_recall_button"
	desc = "mr_botanical_expedition_recall_button_desc"

	visible = { 
		has_modifier = dubois_botanical_expedition_modifier
	}

	possible = {
		NOR = {
			has_modifier = dubois_naturalist_travell_to_location_modifier
			has_modifier = dubois_naturalist_travell_from_location_modifier
		}
		dubois_naturalist_sick = no
	}

	effect = {
		var:dubois_naturalist_var = {
			set_character_busy = no
		}
		dubois_set_naturalist_to_default = yes
		remove_modifier = dubois_botanical_expedition_modifier
		add_modifier = {
			name = dubois_naturalist_travell_from_location_modifier
			days = 90
		}
	}

	ai_chance = {
		base = 0
	}
}

######PALEONTOLOGICAL EXPEDITION######

mr_paleontological_expedition_button = {
	name = "mr_paleontological_expedition_button"
	desc = "mr_paleontological_expedition_button_desc"

	visible = { 
		NOR = {
			has_modifier = dubois_paleontological_research_modifier
			has_modifier = dubois_paleontologist_travell_to_location_modifier
			has_modifier = dubois_paleontologist_travell_from_location_modifier
		}
	}

	possible = {
		dubois_has_active_paleontologist = yes
		OR = {
			dubois_has_formation = yes
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = paleontological_license
				}				
				dubois_has_formation = yes
			}
		}
		NOT = {
			has_variable = dubois_paleontological_expedition_destination_selection_var
		}
	}

	effect = {
		trigger_event = { 
			id = dubois.201
			popup = yes 
		}
		set_variable = dubois_paleontological_expedition_destination_selection_var
	}

	ai_chance = {
		base = 0
	}
}

mr_paleontological_expedition_recall_button = {
	name = "mr_paleontological_expedition_recall_button"
	desc = "mr_paleontological_expedition_recall_button_desc"

	visible = { 
		has_modifier = dubois_paleontological_research_modifier
	}

	possible = {
		NOR = {
			has_modifier = dubois_paleontologist_travell_to_location_modifier
			has_modifier = dubois_paleontologist_travell_from_location_modifier
		}
	}

	effect = {
		var:dubois_paleontologist_var = {
			set_character_busy = no
		}
		dubois_set_paleontologist_to_default = yes
		remove_modifier = dubois_paleontological_research_modifier
		add_modifier = {
			name = dubois_paleontologist_travell_from_location_modifier
			days = 90
		}
	}

	ai_chance = {
		base = 0
	}
}

###########################################################################

######ARCHAEOLOGICAL EXPEDITIONS######

#Upper Egypt/The Valley of the Kings

mr_upper_egypt_expedition_button = {
	name = "mr_upper_egypt_expedition_button"
	desc = "mr_upper_egypt_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_upper_egypt_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_upper_egypt_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_upper_egypt_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_upper_egypt_modifier
				}
			}		
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_upper_egypt_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Lower Egypt/The Pyramids

mr_lower_egypt_expedition_button = {
	name = "mr_lower_egypt_expedition_button"
	desc = "mr_lower_egypt_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_lower_egypt_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_lower_egypt_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_lower_egypt_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_lower_egypt_modifier
				}
			}		
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_lower_egypt_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_egyptian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#Baghdad/Babylonia

mr_babylonia_expedition_button = {
	name = "mr_babylonia_expedition_button"
	desc = "mr_babylonia_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_babylonia_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_babylonia_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_modern_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_babylonia_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_babylonia_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_babylonia_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Mosul/Assyria

mr_assyria_expedition_button = {
	name = "mr_assyria_expedition_button"
	desc = "mr_assyria_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_assyria_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_assyria_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_early_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_assyria_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_assyria_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}	
		add_modifier = {
			name = lepsius_assyria_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_mesopotamian_artifact_minor >= 100
			}
			add = -90
		}		
	}
}

#Peloponnes/Argolis

mr_argolis_expedition_button = {
	name = "mr_argolis_expedition_button"
	desc = "mr_argolis_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_argolis_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_argolis_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_early_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_argolis_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_argolis_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}	
		add_modifier = {
			name = lepsius_argolis_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor >= 100
			}
			add = -90
		}		
	}
}

#Crete

mr_crete_expedition_button = {
	name = "mr_crete_expedition_button"
	desc = "mr_crete_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_crete_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_crete_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_modern_archaeology_tech
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_crete_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_crete_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_crete_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }	
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_aegean_artifact_minor >= 100
			}
			add = -90
		}	
	}
}

#Yucatán

mr_yucatan_expedition_button = {
	name = "mr_yucatan_expedition_button"
	desc = "mr_yucatan_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_yucatan_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_yucatan_expedition_modifier
		}
	}

	possible = {
		country_rank >= rank_value:major_power
		has_technology_researched = lepsius_antiquarianism_tech
		has_technology_researched = quinine
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_yucatan_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_yucatan_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_yucatan_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#Peru

mr_peru_expedition_button = {
	name = "mr_peru_expedition_button"
	desc = "mr_peru_expedition_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_on_archaeological_expedition = no
		any_country = {			
			any_scope_state = {
				has_modifier = lepsius_peru_modifier
			}
		}
		NOT = {
			has_modifier = lepsius_had_expedition_modifier
		}
		NOT = {
			has_modifier = lepsius_peru_expedition_modifier
		}
	}

	possible = {
		OR = {
			country_rank >= rank_value:major_power
			has_building = building_airport
		}
		has_technology_researched = lepsius_modern_archaeology_tech
		has_technology_researched = military_aviation
		custom_tooltip = {
			text = lepsius_excavation_team_needed_tt
			var:lepsius_excavation_teams >= 1
 		}
		any_scope_character = {
			has_role = general	
			count >= 1
		}
		lepsius_has_active_archaeologist = yes
		OR = {
			any_scope_state = {
				has_modifier = lepsius_peru_modifier
			}
			any_country = {
				has_diplomatic_pact = {
					who = ROOT
					type = excavation_license
				}				
				any_scope_state = {
					has_modifier = lepsius_peru_modifier
				}
			}
		}
	}

	effect = {
		custom_tooltip = {
			text = lepsius_sub_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = -1
 			}
 		}
		add_modifier = {
			name = lepsius_peru_expedition_modifier
		}
		trigger_event = { id = lepsius.100 popup = yes }			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 50
			}
			add = 100
		}		
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor < 100
			}
			add = 25
		}	
		modifier = {
			trigger = {
				var:lepsius_precolumbian_artifact_minor >= 100
			}
			add = -90
		}
	}
}

#################################

###Inspect and Cancel Excavation###

#Inspect Excavation

mr_inspect_excavation_button = {
	name = "mr_inspect_excavation_button"
	desc = "mr_inspect_excavation_button_desc"

	visible = { 
		lepsius_has_discovery_excavation = yes
		lepsius_on_excavation_inspection = no
		NOT = {
			has_modifier = lepsius_recent_excavation_inspection_modifier
		}
		NOT = {
			has_variable = lepsius_inspect_excavation_decision_on
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_inspect_excavation_tt
			lepsius_has_discovery_excavation = yes
 		}
		custom_tooltip = {
			text = lepsius_has_artifacts_for_discovery_tt
			lepsius_has_artifacts_for_discovery = yes
 		}
		has_technology_researched = lepsius_modern_archaeology_tech
		OR = {
			lepsius_has_active_experienced_archaeologist = yes
			lepsius_has_active_famous_archaeologist = yes
		}
	}

	effect = {
		set_variable = lepsius_inspect_excavation_decision_on
		trigger_event = { 
			id = lepsius.801 
			popup = yes 
		}		
	}

	ai_chance = {
		base = 100
	}
}

#Cancel Excavation

mr_cancel_excavation_button = {
	name = "mr_cancel_excavation_button"
	desc = "mr_cancel_excavation_button_desc"

	visible = { 
		is_player = yes
		lepsius_on_archaeological_excavation = yes
		lepsius_on_excavation_inspection = no
		NOT = {
			has_variable = lepsius_cancel_excavation_decision_on
		}
	}

	possible = {
		custom_tooltip = {
			text = lepsius_on_archaeological_excavation_tt
			lepsius_on_archaeological_excavation = yes
 		}
	}

	effect = {
		set_variable = lepsius_cancel_excavation_decision_on
		trigger_event = { id = lepsius.190 popup = yes }		
	}

	ai_chance = {
		base = 0
	}
}

#################################

###Excavation Teams###

#First Team

mr_first_excavation_team_button = {
	name = "mr_first_excavation_team_button"
	desc = "mr_first_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		NOT = {
			has_variable = lepsius_first_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_antiquarianism_tech
		any_scope_building = {
			is_building_type = building_university
			level >= 3
		}
		literacy_rate >= 0.33
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}	
		set_variable = lepsius_first_excavation_team			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#Second Team

mr_second_excavation_team_button = {
	name = "mr_second_excavation_team_button"
	desc = "mr_second_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_antiquarianism_tech
		has_variable = lepsius_first_excavation_team
		NOT = {
			has_variable = lepsius_second_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_antiquarianism_tech
		lepsius_has_experienced_archaeologist = yes
		any_scope_building = {
			is_building_type = building_lepsius_archaeological_museum
		}
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}	
		set_variable = lepsius_second_excavation_team			
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#Third Team

mr_third_excavation_team_button = {
	name = "mr_third_excavation_team_button"
	desc = "mr_third_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_modern_archaeology_tech
		has_variable = lepsius_first_excavation_team
		has_variable = lepsius_second_excavation_team
		NOT = {
			has_variable = lepsius_third_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		any_scope_building = {
			is_building_type = building_university
			level >= 15
		}
		literacy_rate >= 0.66
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}		
		set_variable = lepsius_third_excavation_team		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#Fourth Team

mr_fourth_excavation_team_button = {
	name = "mr_fourth_excavation_team_button"
	desc = "mr_fourth_excavation_team_button_desc"

	visible = { 
		has_technology_researched = lepsius_modern_archaeology_tech
		has_variable = lepsius_first_excavation_team
		has_variable = lepsius_second_excavation_team
		has_variable = lepsius_third_excavation_team
		NOT = {
			has_variable = lepsius_fourth_excavation_team
		}
	}

	possible = {
		has_technology_researched = lepsius_modern_archaeology_tech
		lepsius_has_famous_archaeologist = yes
	}

	effect = {
		lepsius_total_excavation_teams_add = yes
		custom_tooltip = {
			text = lepsius_add_archaeological_team_tt
			change_variable = {
 				name = lepsius_excavation_teams
 				add = 1
			}
 		}		
		set_variable = lepsius_fourth_excavation_team		
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				weekly_net_fixed_income > money_amount_multiplier_medium
				gold_reserves > 0
			}
			add = 100
		}
		modifier = {
			trigger = {
				NOT = {
					any_country = {
						has_diplomatic_pact = {
							who = ROOT
							type = excavation_license
						}				
						lepsius_has_excavation_site = yes
					}
				}
			}
			add = -1000
		}
	}
}

#################################

#Found an Archaeological Society

mr_found_archaeological_society_button = {
	name = "mr_found_archaeological_society_button"
	desc = "mr_found_archaeological_society_button_desc"

	visible = {
		NOT = {
			has_modifier = lepsius_archaeological_society_modifier
		}
	}

	possible = {
		any_scope_building = {
			is_building_type = building_lepsius_archaeological_museum
		}
		has_technology_researched = lepsius_early_archaeology_tech
		lepsius_has_famous_archaeologist = yes
	}

	effect = {
		add_modifier = {
			name = lepsius_archaeological_society_modifier
		}		
	}

	ai_chance = {
		base = 100
	}
}