###########################
# AGASSIZ SCRPITED EFFECTS #
###########################

#Effect to add $AMOUNT$ (Generic) Minerals
agassiz_add_x_generic_minerals_effect = {
	# Amount = amount of Minerals to add
	save_temporary_scope_value_as = { #This is used to display the amount in the tooltip
		name = generic_minerals_amount
		value = $AMOUNT$
	}
	
	#This part is used to display an accurate tooltip (Gain, loss, etc.)
	if = { #Negative Plural Tooltip if local_var is negative
		limit = { $AMOUNT$ < 0 }
		custom_tooltip = agassiz_add_x_generic_minerals_minus_x_tt
	}
	if = { #Neutral Tooltip if $AMOUNT$ is 0
		limit = { $AMOUNT$ = 0 }
		custom_tooltip = agassiz_add_x_generic_minerals_0_tt
	}
	if = { #Positive Plural Tooltip if $AMOUNT$ is positive
		limit = { $AMOUNT$ > 0 }
		custom_tooltip = agassiz_add_x_generic_minerals_plus_x_tt
	}

	#Yearly Minerals are used for the geological report, they are added with each normal minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_yearly_generic_minerals_var
			}
		}
		set_variable = {
			name = agassiz_yearly_generic_minerals_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_yearly_generic_minerals_var
		add = $AMOUNT$
	}

	#This part adds the AMOUNT of Minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_generic_minerals_var
			}
		}
		set_variable = {
			name = agassiz_generic_minerals_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_generic_minerals_var
		add = scope:generic_minerals_amount
	}
}

#Effect to add $AMOUNT$ Rare Minerals
agassiz_add_x_rare_minerals_effect = {
	# Amount = amount of Minerals to add
	save_temporary_scope_value_as = { #This is used to display the amount in the tooltip
		name = rare_minerals_amount
		value = $AMOUNT$
	}
	
	#This part is used to display an accurate tooltip (Gain, loss, etc.)
	if = { #Negative Plural Tooltip if local_var is negative
		limit = { $AMOUNT$ < 0 }
		custom_tooltip = agassiz_add_x_rare_minerals_minus_x_tt
	}
	if = { #Neutral Tooltip if $AMOUNT$ is 0
		limit = { $AMOUNT$ = 0 }
		custom_tooltip = agassiz_add_x_rare_minerals_0_tt
	}
	if = { #Positive Plural Tooltip if $AMOUNT$ is positive
		limit = { $AMOUNT$ > 0 }
		custom_tooltip = agassiz_add_x_rare_minerals_plus_x_tt
	}

	#Yearly Minerals are used for the geological report, they are added with each normal minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_yearly_rare_minerals_var
			}
		}
		set_variable = {
			name = agassiz_yearly_rare_minerals_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_yearly_rare_minerals_var
		add = $AMOUNT$
	}

	#This part adds the AMOUNT of Minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_rare_minerals_var
			}
		}
		set_variable = {
			name = agassiz_rare_minerals_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_rare_minerals_var
		add = scope:rare_minerals_amount
	}
}

#Effect to add $AMOUNT$ Geological Knowledge
agassiz_add_x_geological_knowledge_effect = {
	# Amount = amount of Minerals to add
	save_temporary_scope_value_as = { #This is used to display the amount in the tooltip
		name = geological_knowledge_amount
		value = $AMOUNT$
	}
	
	#This part is used to display an accurate tooltip (Gain, loss, etc.)
	if = { #Negative Plural Tooltip if local_var is negative
		limit = { $AMOUNT$ < 0 }
		custom_tooltip = agassiz_add_x_geological_knowledge_minus_x_tt
	}
	if = { #Neutral Tooltip if $AMOUNT$ is 0
		limit = { $AMOUNT$ = 0 }
		custom_tooltip = agassiz_add_x_geological_knowledge_0_tt
	}
	if = { #Positive Plural Tooltip if $AMOUNT$ is positive
		limit = { $AMOUNT$ > 0 }
		custom_tooltip = agassiz_add_x_geological_knowledge_plus_x_tt
	}

	#Yearly Minerals are used for the geological report, they are added with each normal minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_yearly_geological_knowledge_var
			}
		}
		set_variable = {
			name = agassiz_yearly_geological_knowledge_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_yearly_geological_knowledge_var
		add = $AMOUNT$
	}

	#This part adds the AMOUNT of Minerals
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = agassiz_geological_knowledge_var
			}
		}
		set_variable = {
			name = agassiz_geological_knowledge_var
			value = 0
		}
	}
	change_variable = {
		name = agassiz_geological_knowledge_var
		add = scope:geological_knowledge_amount
	}
	change_global_variable = {
		name = agassiz_geological_knowledge_global_var
		add = scope:geological_knowledge_amount
	}
}

######GEOLOGY IMPROVEMENT######

#This Scripted Effect calculates the Geologist Improvement Progress
agassiz_geologist_improvement_progress = {
	set_variable = {
		name = agassiz_monthly_geologist_improvement_progress_var
		value = 1 #Base Value
	}
	if = { #Has Chemist
		limit = {
			dubois_has_geologist = yes
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 1
		}
	}
	if = { #Experience of the chemist divided by 100
		limit = {
			dubois_has_geologist = yes
		}
		if = {
			limit = {
				var:dubois_geologist_var.var:dubois_geologist_experience < 300
			}
			set_local_variable = {
				name = geologist_experience_add
				value = var:dubois_geologist_var.var:dubois_geologist_experience
			}
			change_local_variable = {
				name = geologist_experience_add
				divide = 300
			}
			change_variable = {
				name = agassiz_monthly_geologist_improvement_progress_var
				add = local_var:geologist_experience_add
			}
		}
		else = {
			change_variable = {
				name = agassiz_monthly_geologist_improvement_progress_var
				add = 1
			}
		}
		if = {
			limit = {
				var:dubois_geologist_var.var:dubois_geologist_experience < 300
			}
			set_variable = {
				name = geologist_experience_add_var
				value = var:dubois_geologist_var.var:dubois_geologist_experience
			}
			change_variable = {
				name = geologist_experience_add_var
				divide = 300
			}
		}
		else = {
			set_variable = {
				name = geologist_experience_add_var
				value = 1
			}
		}
	}
	if = { #Geologist is Prospector
		limit = {
			dubois_has_geologist = yes
			var:dubois_geologist_var = {
				has_trait = agassiz_prospector
			}
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 1
		}
	}
	if = { #Geologist is Mineralogist
		limit = {
			dubois_has_geologist = yes
			var:dubois_geologist_var = {
				has_trait = agassiz_mineralogist
			}
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 0.5
		}
	}
	if = { #Geologist is Geophysicist
		limit = {
			dubois_has_geologist = yes
			var:dubois_geologist_var = {
				has_trait = agassiz_geophysicist
			}
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 0.5
		}
	}
	if = { #Geologist is Volcanologist
		limit = {
			dubois_has_geologist = yes
			var:dubois_geologist_var = {
				has_trait = agassiz_volcanologist
			}
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 0.2
		}
	}
	if = { #Geologist has Persistent Trait
		limit = {
			dubois_has_geologist = yes
			var:dubois_geologist_var = {
				has_trait = persistent
			}
		}
		change_variable = {
			name = agassiz_monthly_geologist_improvement_progress_var
			add = 0.5
		}
	}
}

agassiz_remove_je_cost_modifiers_effect = {
	if = {
		limit = { has_modifier = agassiz_ore_search_cost_modifier }
		remove_modifier = agassiz_ore_search_cost_modifier
	}
}

######AGE OF EARTH######

agassiz_set_start_age_of_earth_effect = {
	if = {
		limit = {
			game_date >= 1830.1.1
		}
		set_global_variable = {
			name = agassiz_global_age_of_earth_var
			value = 20 #Lyell in 1830
		}
	}
	else_if = {
		limit = {
			game_date >= 1779.1.1
		}
		set_global_variable = {
			name = agassiz_global_age_of_earth_var
			value = 10 #Buffon in 1779
		}
	}
	else = {
		set_global_variable = {
			name = agassiz_global_age_of_earth_var
			value = 1 #Basic
		}
	}
}

agassiz_set_new_age_of_earth_effect = {
	custom_tooltip = {
		text = agassiz_set_new_age_of_earth_effect_tt
		remove_global_variable = agassiz_global_age_of_earth_var
		set_global_variable = {
			name = agassiz_global_age_of_earth_var
			value = agassiz_country_age_of_earth_calculation_value
		}
		random_country = {
			limit = {
				has_variable = agassiz_current_age_of_earth_calculator_var
			}
			remove_variable = agassiz_current_age_of_earth_calculator_var
		}
		set_variable = agassiz_current_age_of_earth_calculator_var
	}
}

######ADD VARIABLE######

agassiz_add_variables = {
	set_variable = {
		name = agassiz_generic_minerals_var
		value = 0
	}
	set_variable = {
		name = agassiz_rare_minerals_var
		value = 0
	}
	set_variable = {
		name = agassiz_geological_knowledge_var
		value = 0
	}
	######Add all variables######
	set_variable = agassiz_variables_var
}