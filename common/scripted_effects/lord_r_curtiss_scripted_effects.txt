############################
# CURTISS SCRIPTED EFFECTS #
############################

#by Lord R

##########################

###RESEARCH BOOST###

big_curtiss_ballooning_research_effect = {
	if = {
		limit = {
			can_research = curtiss_messenger_pidgeons_tech
		}
		add_technology_progress = {
			progress = 3500
			technology = curtiss_messenger_pidgeons_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_reconnaissance_balloon_tech
		}
		add_technology_progress = {
			progress = 3500
			technology = curtiss_reconnaissance_balloon_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_early_aviation_tech
		}
		add_technology_progress = {
			progress = 3500
			technology = curtiss_early_aviation_tech
		}
	}
	else_if = {
		limit = {
			can_research = zeppelins
		}
		add_technology_progress = {
			progress = 3500
			technology = zeppelins
		}
	}
	else = {
		add_modifier = {
			name = curtiss_balloon_experiments_modifier
			months = 24
		}
	}
}

medium_curtiss_ballooning_research_effect = {
	if = {
		limit = {
			can_research = curtiss_messenger_pidgeons_tech
		}
		add_technology_progress = {
			progress = 2000
			technology = curtiss_messenger_pidgeons_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_reconnaissance_balloon_tech
		}
		add_technology_progress = {
			progress = 2000
			technology = curtiss_reconnaissance_balloon_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_early_aviation_tech
		}
		add_technology_progress = {
			progress = 2000
			technology = curtiss_early_aviation_tech
		}
	}
	else_if = {
		limit = {
			can_research = zeppelins
		}
		add_technology_progress = {
			progress = 2000
			technology = zeppelins
		}
	}
	else = {
		add_modifier = {
			name = curtiss_balloon_experiments_modifier
			months = 12
		}
	}
}

small_curtiss_ballooning_research_effect = {
	if = {
		limit = {
			can_research = curtiss_messenger_pidgeons_tech
		}
		add_technology_progress = {
			progress = 1000
			technology = curtiss_messenger_pidgeons_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_reconnaissance_balloon_tech
		}
		add_technology_progress = {
			progress = 1000
			technology = curtiss_reconnaissance_balloon_tech
		}
	}
	else_if = {
		limit = {
			can_research = curtiss_early_aviation_tech
		}
		add_technology_progress = {
			progress = 1000
			technology = curtiss_early_aviation_tech
		}
	}
	else_if = {
		limit = {
			can_research = zeppelins
		}
		add_technology_progress = {
			progress = 1000
			technology = zeppelins
		}
	}
	else = {
		add_modifier = {
			name = curtiss_balloon_experiments_modifier
			months = 6
		}
	}
}

curtiss_ballooning_research_if_record_all_effect = {
	if = {
		limit = {
			OR = {
				curtiss_altitude_record_global_broken_trigger = yes
				curtiss_distance_record_global_broken_trigger = yes
				curtiss_time_record_global_broken_trigger = yes
			}
		}
		big_curtiss_ballooning_research_effect = yes
		var:curtiss_balloonist_var = {
		}
	}
	else_if = {
		limit = {
			OR = {
				curtiss_altitude_record_country_broken_trigger = yes
				curtiss_distance_record_country_broken_trigger = yes
				curtiss_time_record_country_broken_trigger = yes
			}
		}
		medium_curtiss_ballooning_research_effect = yes
	}
	else = {
		small_curtiss_ballooning_research_effect = yes
	}
}

###BALLOON RECORDS###

#Altitude
curtiss_new_balloon_altitude_effect = {
	if = {
		limit = {
			has_technology_researched = arc_welding
		}
		set_variable = {
			name = new_balloon_altitude_var
			value = { 14000 22100 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = electric_arc_process
		}
		set_variable = {
			name = new_balloon_altitude_var
			value = { 10000 16000 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = steel_railway_cars
		}
		set_variable = {
			name = new_balloon_altitude_var
			value = { 7000 12000 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_reconnaissance_balloon_tech
		}
		set_variable = {
			name = new_balloon_altitude_var
			value = { 5000 10000 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_montgolfier_balloon_tech
		}
		set_variable = {
			name = new_balloon_altitude_var
			value = { 2000 5000 }
		}
	}
	else = {
		set_variable = {
			name = new_balloon_altitude_var
			value = { 100 2000 }
		}
	}

	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = brave
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = ambitious
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = meticulous
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = innovative
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_experienced
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_famous
			}
		}
		change_variable = {
			name = new_balloon_altitude_var
			multiply = 1.2
		}
	}

	round_variable = {
		name = new_balloon_altitude_var
		nearest = 10
	}
}

curtiss_balloon_country_altitude_record_effect = {
	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_altitude_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_altitude_record_var
			value = var:new_balloon_altitude_var
		}
	}
	balloonist_experience_gain_effect = { #if no record is broken, a total of 50 experience is added
		AMOUNT = "10"
	}
	if = {
		limit = {
			var:new_balloon_altitude_var > var:curtiss_balloon_altitude_record_var
		}
		set_variable = {
			name = curtiss_balloon_altitude_record_var
			value = var:new_balloon_altitude_var
		}
		balloonist_experience_gain_effect = { #if country record is broken, a total of 25 experience is added
			AMOUNT = "15"
		}
	}
	if = {
		limit = {
			var:new_balloon_altitude_var > global_var:curtiss_balloon_altitude_record_global_var
		}
		set_global_variable = {
			name = curtiss_balloon_altitude_record_global_var
			value = var:new_balloon_altitude_var
		}
		set_global_variable = {
			name = curtiss_balloon_altitude_record_holder_global_var
			value = root
		}
		add_modifier = { #adds modifier to new country
			name = curtiss_balloon_altitude_record_modifier
		}

		every_country = { #removes modifier from old country
			limit = {
				has_modifier = curtiss_balloon_altitude_record_modifier
			}
			remove_modifier = curtiss_balloon_altitude_record_modifier
		}

		balloonist_experience_gain_effect = { #if world record is broken, a total of 50 experience is added
			AMOUNT = "25"
		}
	}
}

#Distance
curtiss_new_balloon_distance_effect = {
	if = {
		limit = {
			has_technology_researched = curtiss_modern_aviation_tech
		}
		set_variable = {
			name = new_balloon_distance_var
			value = { 2200 4200 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = zeppelins
		}
		set_variable = {
			name = new_balloon_distance_var
			value = { 1400 2800 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_early_aviation_tech
		}
		set_variable = {
			name = new_balloon_distance_var
			value = { 1000 2000 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_reconnaissance_balloon_tech
		}
		set_variable = {
			name = new_balloon_distance_var
			value = { 700 1500 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_montgolfier_balloon_tech
		}
		set_variable = {
			name = new_balloon_distance_var
			value = { 400 800 }
		}
	}
	else = {
		set_variable = {
			name = new_balloon_distance_var
			value = { 10 400 }
		}
	}

	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = brave
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = ambitious
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = meticulous
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = innovative
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_experienced
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_famous
			}
		}
		change_variable = {
			name = new_balloon_distance_var
			multiply = 1.2
		}
	}

	round_variable = {
		name = new_balloon_distance_var
		nearest = 1
	}
}

curtiss_balloon_country_distance_record_effect = {
	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_distance_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_distance_record_var
			value = var:new_balloon_distance_var
		}
	}
	balloonist_experience_gain_effect = { #if no record is broken, a total of 50 experience is added
		AMOUNT = "10"
	}
	if = {
		limit = {
			var:new_balloon_distance_var > var:curtiss_balloon_distance_record_var
		}
		set_variable = {
			name = curtiss_balloon_distance_record_var
			value = var:new_balloon_distance_var
		}
		balloonist_experience_gain_effect = { #if country record is broken, a total of 25 experience is added
			AMOUNT = "15"
		}
	}
	if = {
		limit = {
			var:new_balloon_distance_var > global_var:curtiss_balloon_distance_record_global_var
		}
		set_global_variable = {
			name = curtiss_balloon_distance_record_global_var
			value = var:new_balloon_distance_var
		}
		set_global_variable = {
			name = curtiss_balloon_distance_record_holder_global_var
			value = root
		}
	
		add_modifier = { #adds modifier to new country
			name = curtiss_balloon_distance_record_modifier
		}
		every_country = { #removes modifier from old country
			limit = {
				has_modifier = curtiss_balloon_distance_record_modifier
			}
			remove_modifier = curtiss_balloon_distance_record_modifier
		}
		balloonist_experience_gain_effect = { #if world record is broken, a total of 50 experience is added
			AMOUNT = "25"
		}
	}
}

#Time
curtiss_new_balloon_time_effect = {
	if = {
		limit = {
			has_technology_researched = curtiss_modern_aviation_tech
		}
		set_variable = {
			name = new_balloon_time_var
			value = { 10 55 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = zeppelins
		}
		set_variable = {
			name = new_balloon_time_var
			value = { 5 25 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_early_aviation_tech
		}
		set_variable = {
			name = new_balloon_time_var
			value = { 3 15 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_reconnaissance_balloon_tech
		}
		set_variable = {
			name = new_balloon_time_var
			value = { 2 10 }
		}
	}
	else_if = {
		limit = {
			has_technology_researched = curtiss_montgolfier_balloon_tech
		}
		set_variable = {
			name = new_balloon_time_var
			value = { 1 7 }
		}
	}
	else = {
		set_variable = {
			name = new_balloon_time_var
			value = { 1 2 }
		}
	}

	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = brave
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = ambitious
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = meticulous
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.05
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = innovative
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_experienced
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.1
		}
	}
	if = {
		limit = {
			var:curtiss_balloonist_var = {
				has_trait = curtiss_balloonist_famous
			}
		}
		change_variable = {
			name = new_balloon_time_var
			multiply = 1.2
		}
	}

	round_variable = {
		name = new_balloon_time_var
		nearest = 0.1
	}
}

curtiss_balloon_country_time_record_effect = {
	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_time_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_time_record_var
			value = var:new_balloon_time_var
		}
	}
	balloonist_experience_gain_effect = { #if no record is broken, a total of 50 experience is added
		AMOUNT = "10"
	}
	if = {
		limit = {
			var:new_balloon_time_var > var:curtiss_balloon_time_record_var
		}
		set_variable = {
			name = curtiss_balloon_time_record_var
			value = var:new_balloon_time_var
		}
		balloonist_experience_gain_effect = { #if country record is broken, a total of 25 experience is added
			AMOUNT = "15"
		}
	}
	if = {
		limit = {
			var:new_balloon_time_var > global_var:curtiss_balloon_time_record_global_var
		}
		set_global_variable = {
			name = curtiss_balloon_time_record_global_var
			value = var:new_balloon_time_var
		}
		set_global_variable = {
			name = curtiss_balloon_time_record_holder_global_var
			value = root
		}

		every_country = { #removes modifier from old country
			limit = {
				has_modifier = curtiss_balloon_time_record_modifier
			}
			remove_modifier = curtiss_balloon_time_record_modifier
		}
		add_modifier = { #adds modifier to new country
			name = curtiss_balloon_time_record_modifier
		}
		balloonist_experience_gain_effect = { #if world record is broken, a total of 50 experience is added
			AMOUNT = "25"
		}
	}
}

###Create Balloonist###
create_balloonist_effect = {
	create_character = {
		save_scope_as = curtiss_balloonist_scope
	}
		
	scope:curtiss_balloonist_scope = {
		add_trait = curtiss_balloonist
		place_character_in_void = 1200
		set_variable = {
			name = curtiss_balloonist_experience_var
			value = 0
		}
	}

	add_journal_entry = {
		type = je_curtiss_balloonist
	}
		
	set_variable = {
		name = curtiss_balloonist_var
		value = scope:curtiss_balloonist_scope
	}
}

###Adds the right cost modifier to the country###
balloonist_cost_effect = {
	if = {
		limit = {
			is_player = yes
		}
		add_modifier = {
			name = curtiss_sponsoring_balloonist_modifier
		}
	}
	else = {
		add_modifier = {
			name = curtiss_sponsoring_balloonist_ai_modifier
		}
	}
}

###Kill balloonist###
kill_balloonist_effect = {
	var:curtiss_balloonist_var = {
		free_character_from_void = no
	}

	remove_variable = curtiss_balloonist_var

	if = {
		limit = {
			has_modifier = curtiss_sponsoring_balloonist_modifier
		}
		remove_modifier = curtiss_sponsoring_balloonist_modifier
	}
	else = {
		remove_modifier = curtiss_sponsoring_balloonist_ai_modifier
	}
}

#Balloonist Experience gain
balloonist_experience_gain_effect = { #adds XP to the balloonist
	# Amount = amountof XP to add
	var:curtiss_balloonist_var = {
		change_variable = {
			name = curtiss_balloonist_experience_var
			add = $AMOUNT$
		}
	}
}

###Set up records for journal entry###
set_up_records_je_effect = {
	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_altitude_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_altitude_record_var
			value = 0
		}
	}

	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_distance_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_distance_record_var
			value = 0
		}
	}

	if = {
		limit = {
			NOT = {
				has_variable = curtiss_balloon_time_record_var
			}
		}
		set_variable = {
			name = curtiss_balloon_time_record_var
			value = 0
		}
	}
}