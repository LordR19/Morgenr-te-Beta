############################
# VERRIER SCRIPTED EFFECTS #
############################

#by Marco Dandolo

#############################

###Add Technology###

#Small Add

verrier_small_add_technology = {
	if = {
		limit = {
			has_technology_researched = mechanical_tools
			NOT = {
				has_technology_researched = verrier_astronomy_tech
			}
			can_research = verrier_astronomy_tech
		}
		add_technology_progress = { progress = 1500 technology = verrier_astronomy_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			NOT = {
				has_technology_researched = verrier_electromagnetism_tech
			}
			can_research = verrier_electromagnetism_tech
		}
		add_technology_progress = { progress = 1500 technology = verrier_electromagnetism_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = verrier_electromagnetism_tech
			NOT = {
				has_technology_researched = electrical_generation
			}
			can_research = electrical_generation
		}
		add_technology_progress = { progress = 3000 technology = electrical_generation }
	}
	if = {
		limit = {
			has_technology_researched = electrical_generation
			NOT = {
				has_technology_researched = combustion_engine
			}
			can_research = combustion_engine
		}
		add_technology_progress = { progress = 3000 technology = combustion_engine }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = electrical_generation
			has_technology_researched = combustion_engine
			has_technology_researched = verrier_electromagnetism_tech
		}
	}
}

#Medium Add

verrier_medium_add_technology = {
	if = {
		limit = {
			has_technology_researched = mechanical_tools
			NOT = {
				has_technology_researched = verrier_astronomy_tech
			}
			can_research = verrier_astronomy_tech
		}
		add_technology_progress = { progress = 3500 technology = verrier_astronomy_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			NOT = {
				has_technology_researched = verrier_electromagnetism_tech
			}
			can_research = verrier_electromagnetism_tech
		}
		add_technology_progress = { progress = 3500 technology = verrier_electromagnetism_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = verrier_electromagnetism_tech
			NOT = {
				has_technology_researched = electrical_generation
			}
			can_research = electrical_generation
		}
		add_technology_progress = { progress = 5500 technology = electrical_generation }
	}
	if = {
		limit = {
			has_technology_researched = electrical_generation
			NOT = {
				has_technology_researched = combustion_engine
			}
			can_research = combustion_engine
		}
		add_technology_progress = { progress = 5500 technology = combustion_engine }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = electrical_generation
			has_technology_researched = combustion_engine
			has_technology_researched = verrier_electromagnetism_tech
		}
	}
}

#Large Add

verrier_large_add_technology = {
	if = {
		limit = {
			has_technology_researched = mechanical_tools
			NOT = {
				has_technology_researched = verrier_astronomy_tech
			}
			can_research = verrier_astronomy_tech
		}
		add_technology_progress = { progress = 6000 technology = verrier_astronomy_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			NOT = {
				has_technology_researched = verrier_electromagnetism_tech
			}
			can_research = verrier_electromagnetism_tech
		}
		add_technology_progress = { progress = 6000 technology = verrier_electromagnetism_tech }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = verrier_electromagnetism_tech
			NOT = {
				has_technology_researched = electrical_generation
			}
			can_research = electrical_generation
		}
		add_technology_progress = { progress = 9000 technology = electrical_generation }
	}
	if = {
		limit = {
			has_technology_researched = electrical_generation
			NOT = {
				has_technology_researched = combustion_engine
			}
			can_research = combustion_engine
		}
		add_technology_progress = { progress = 9000 technology = combustion_engine }
	}
	if = {
		limit = {
			has_technology_researched = verrier_astronomy_tech
			has_technology_researched = electrical_generation
			has_technology_researched = combustion_engine
			has_technology_researched = verrier_electromagnetism_tech
		}
	}
}

#############################

###ASTRONOMICAL OBJECTS###

#Effect to add $AMOUNT$ Astronomical Objects
verrier_add_x_astronomical_objects_effect = {
	# Amount = amount of artifacts to add
	save_temporary_scope_value_as = { #This is used to display the amount in the tooltip
		name = astronomical_objects_amount
		value = $AMOUNT$
	}

	#This part is used to display an accurate tooltip (Gain, loss, etc.)
	if = { #Negative Plural Tooltip if $AMOUNT$ is negative
		limit = { $AMOUNT$ < -1 }
		custom_tooltip = verrier_add_x_astronomical_objects_minus_x_tt
	}
	if = { #Negative Singular Tooltip if $AMOUNT$ is negative
		limit = { $AMOUNT$ = -1 }
		custom_tooltip = verrier_add_x_astronomical_objects_minus_1_tt
	}
	if = { #Neutral Tooltip if $AMOUNT$ is 0
		limit = { $AMOUNT$ = 0 }
		custom_tooltip = verrier_add_x_astronomical_objects_0_tt
	}
	if = { #Positive Plural Tooltip if $AMOUNT$ is positive
		limit = { $AMOUNT$ = 1 }
		custom_tooltip = verrier_add_x_astronomical_objects_plus_1_tt
	}
	if = { #Positive Plural Tooltip if $AMOUNT$ is positive
		limit = { $AMOUNT$ > 1 }
		custom_tooltip = verrier_add_x_astronomical_objects_plus_x_tt
	}

	#Yearly Astronomical Objects are used for the astronomical report, they are added with each normal astronomical object
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = verrier_yearly_astronomical_objects_var
			}
		}
		set_variable = {
			name = verrier_yearly_astronomical_objects_var
			value = 0
		}
	}
	change_variable = {
		name = verrier_yearly_astronomical_objects_var
		add = $AMOUNT$
	}

	#This part adds the AMOUNT of Astronomical Objects
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_variable = verrier_astronomical_objects
			}
		}
		set_variable = {
			name = verrier_astronomical_objects
			value = 0
		}
	}
	change_variable = {
		name = verrier_astronomical_objects
		add = $AMOUNT$
	}

	#This part adds the AMOUNT to the global variable, that keeps track of the total amount of astronomical objects
	if = { #Fallback if the variable does not exist yet
		limit = {
			NOT = {
				has_global_variable = verrier_total_astronomical_objects
			}
		}
		set_global_variable = {
			name = verrier_total_astronomical_objects
			value = 0
		}
	}
	change_global_variable = {
		name = verrier_total_astronomical_objects
		add = $AMOUNT$
	}

	#verrier_astronomer_total_objects_var is used to keep track of all the astronomical objects that a specific Astronomer found.
	#It is used to show how successful the astronomer is.
	#Every time a normal astronomical object is added, the same number gets added here.
	if = {
		limit = { #Only works if there actually is an Astronomer
			has_variable = verrier_astronomer_var
		}
		var:verrier_astronomer_var = {
			if = { #Fallback if the variable does not exist yet
				limit = {
					NOT = {
						has_variable = verrier_astronomer_total_objects_var
					}
				}
				set_variable = {
					name = verrier_astronomer_total_objects_var
					value = 0
				}
			}
			change_variable = { #The amount of Astronomical Objects that this Astronomer discovered
				name = verrier_astronomer_total_objects_var
				add = $AMOUNT$
			}
		}
	}
}


#Effect to add a specific amount of astronomical objects to the astronomer and the the yearly discovered objects
#NUMBER = How many astronomical objects will be added
verrier_set_objects_astronomer_yearly = {
	if = {
		limit = {
			NOT = {
				has_variable = verrier_yearly_astronomical_objects_var
			}
		}
		set_variable = {
			name = verrier_yearly_astronomical_objects_var
			value = 0
		}
	}
	if = {
		limit = {
			has_variable = verrier_astronomer_var
			NOT = {
				var:verrier_astronomer_var = {
					has_variable = verrier_astronomer_total_objects_var
				}
			}
		}
		var:verrier_astronomer_var = {
			set_variable = {
				name = verrier_astronomer_total_objects_var
				value = 0
			}
		}
	}
	change_variable = {
		name = verrier_yearly_astronomical_objects_var
		add = $NUMBER$
	}
	if = {
		limit = {
			has_variable = verrier_astronomer_var
		}
		var:verrier_astronomer_var = {
			change_variable = {
				name = verrier_astronomer_total_objects_var
				add = $NUMBER$
			}
		}
	}
}

#############################

###MOON PHOTOS###

#1 moon photo

verrier_add_1_moon_photo = {
	change_variable = {
 		name = verrier_moon_photo
 		add = 1
	}
	custom_tooltip = verrier_add_1_moon_photo_tt
}

#2 moon photos

verrier_add_2_moon_photo = {
	change_variable = {
 		name = verrier_moon_photo
 		add = 2
	}
	custom_tooltip = verrier_add_2_moon_photo_tt
}

#3 moon photos

verrier_add_3_moon_photo = {
	change_variable = {
 		name = verrier_moon_photo
 		add = 3
	}
	custom_tooltip = verrier_add_3_moon_photo_tt
}

#############################

###GREAT COMETS###

verrier_add_great_comet_object = {
	change_variable = {
 		name = verrier_great_comet
 		add = 1
	}
	change_global_variable = {
 		name = verrier_total_verrier_great_comet
 		add = 1
	}
	custom_tooltip = verrier_add_great_comet_object_tt
}


##############################

verrier_add_variables = {
	set_variable = {
        name = verrier_astronomical_objects
        value = 0
	}
	set_variable = {
        name = verrier_moon_photo
        value = 0
	}
	set_variable = {
        name = verrier_great_comet
        value = 0
	}
	set_variable = verrier_variables_var
}

##############################

#Script to research astronomy technologies
verrier_astronomy_research_boost = {
	if = {
		limit = {
			can_research = verrier_physics_tech
		}
		add_technology_progress = {
			progress = 2500
			technology = verrier_physics_tech
		}
	}
	else_if = {
		limit = {
			can_research = verrier_astronomy_tech
		}
		add_technology_progress = {
			progress = 2000
			technology = verrier_astronomy_tech
		}
	}
}
