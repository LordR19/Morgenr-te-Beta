### PALEONTOLOGIST BUTTONS ###

#by Lord R

#Does the country have a paleontologist
mr_has_paleontologist_sgui = {
	scope = country
	is_shown = {
		has_variable = dubois_paleontologist_var
	}
}

#Sets the Ranking up
mr_dinosaur_skeleton_ranking_sgui = {
	scope = country
	effect = {
		dubois_create_dinosaur_skeleton_ranking_list_effect = yes
	}
}

#MR_PALEONTOLOGICAL_EXPEDITION_BUTTON
mr_paleontological_expedition_button = {
    scope = country
	is_shown = {
		NOT = {
			has_modifier = dubois_paleontological_research_modifier
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_PALEONTOLOGICAL_EXPEDITION_NOT_TRAVELLING_TRIGGER
			NOR = {
				has_modifier = dubois_paleontologist_travell_to_location_modifier
				has_modifier = dubois_paleontologist_travell_from_location_modifier
			}
		}
		custom_tooltip = {
			text = MR_ACTIVE_PALEONTOLOGIST_TRIGGER
			has_variable = dubois_paleontologist_var
			var:dubois_paleontologist_var = {
				is_busy = no
			}
		}
		custom_tooltip = {
			text = MR_PALEONTOLOGICAL_EXPEDITION_HAS_ACCESS_FORMATION_TRIGGER
			OR = {
				dubois_has_formation = yes
				any_country = {
					has_diplomatic_pact = {
						who = ROOT
						type = paleontological_license
					}				
					dubois_has_formation = yes
				}
			}
		}
		custom_tooltip = {
			text = MR_PALEONTOLOGICAL_EXPEDITION_NOT_CHOOSING_CURRENTLY_TRIGGER
			NOT = {
				has_variable = dubois_paleontological_expedition_destination_selection_var
			}
		}
    }
    effect = {
		trigger_event = { 
			id = dubois.201
			popup = yes 
		}
		set_variable = dubois_paleontological_expedition_destination_selection_var
    }
}

#MR_PALEONTOLOGICAL_EXPEDITION_RECALL_BUTTON
mr_paleontological_expedition_recall_button = {
    scope = country
	is_shown = {
		has_modifier = dubois_paleontological_research_modifier
	}
    is_valid = {
		custom_tooltip = {
			text = MR_PALEONTOLOGICAL_EXPEDITION_NOT_TRAVELLING_TRIGGER
			NOR = {
				has_modifier = dubois_paleontologist_travell_to_location_modifier
				has_modifier = dubois_paleontologist_travell_from_location_modifier
			}
		}
    }
    effect = {
		if = {
			limit = { has_variable = dubois_paleontologist_var }
			var:dubois_paleontologist_var = {
				set_character_busy_and_immortal = no
				remove_variable = dubois_paleontologist_in_south_america_var
				remove_variable = dubois_paleontologist_in_north_america_var
				remove_variable = dubois_paleontologist_in_europe_var
				remove_variable = dubois_paleontologist_in_africa_var
				remove_variable = dubois_paleontologist_in_asia_var
				remove_variable = dubois_paleontologist_in_australia_var
				remove_variable = dubois_paleontologist_in_local_var
			}
		}
		dubois_set_paleontologist_to_default = yes
		remove_modifier = dubois_paleontological_research_modifier
		add_modifier = {
			name = dubois_paleontologist_travell_from_location_modifier
			days = 90
		}
    }
}

#MR_TRANSFORM_FOSSILS_TO_BONES_BUTTON
mr_transform_fossils_to_bones_button = {
    scope = country
    is_valid = {
		custom_tooltip = {
			text = MR_TRANSFORM_FOSSILS_TO_BONES_TRANSFORMABLE_DINOSAUR_BONE_TRIGGER
			dubois_has_transformable_dinosaur_bone = yes
		}
		custom_tooltip = {
			text = MR_TRANSFORM_FOSSILS_TO_BONES_FOSSILS_TRIGGER
			var:dubois_fossil >= 20
		}
		custom_tooltip = {
			text = MR_TRANSFORM_FOSSILS_TO_BONES_PALEONTOLOGIST_TRIGGER
			trigger_if = {
				limit = {
					has_variable = dubois_paleontologist_var
				}
				var:dubois_paleontologist_var = {
					OR = {
						has_trait = dubois_paleontologist_experienced
						has_trait = dubois_paleontologist_famous
					}
					is_busy = no
				}
			}
			trigger_else = {
				always = no
			}
		}
    }
    effect = {
		dubois_fossils_for_transformation_effect = yes
		if = {
			limit = { has_variable = dubois_paleontologist_var }
			var:dubois_paleontologist_var = {
				set_character_busy_and_immortal = yes
			}
			random_list = {
				50 = {
					modifier = {
						if = {
							limit = {
								var:dubois_paleontologist_var = {
									var:dubois_paleontologist_experience >= 175
								}
							}
							add = 25
						}
					}
					modifier = {
						if = {
							limit = {
								var:dubois_paleontologist_var = {
									var:dubois_paleontologist_experience >= 200
								}
							}
							add = 25
						}
					}
					modifier = {
						if = {
							limit = {
								var:dubois_paleontologist_var = {
									var:dubois_paleontologist_experience >= 250
								}
							}
							add = 50
						}
					}
					modifier = {
						if = {
							limit = {
								var:dubois_paleontologist_var = {
									var:dubois_paleontologist_experience >= 300
								}
							}
							add = 50
						}
					}
					trigger_event = {
						id = dubois.2042
						days = { 50 60 }
					}
				}
				50 = {
					trigger_event = {
						id = dubois.2043
						days = { 50 60 }
					}
				}
			}
			hidden_effect = {
				trigger_event = {
					id = dubois.2001
					popup = yes
				}
			}
		}
    }
}

#MR_MOUNT_SKELETON_BUTTON
mr_mount_skeleton_button = {
    scope = country
    is_valid = {
		custom_tooltip = {
			text = MR_MOUNT_SKELETON_ACTIVE_BUTTON_TRIGGER
			NOT = { has_variable = mr_mount_dinosaur_skeleton_button_var }
		}
		custom_tooltip = {
			text = MR_REMOUNT_SKELETON_PALEONTOLOGIST_TRIGGER
			trigger_if = {
				limit = {
					has_variable = dubois_paleontologist_var
				}
				var:dubois_paleontologist_var = {
					is_busy = no
					NOT = {
						has_modifier = dubois_exhausted_paleontologist_modifier
					}
				}
			}
			trigger_else = {
				always = no
			}
		}
		custom_tooltip = {
			text = MR_MOUNT_SKELETON_TRIGGER_TT
			OR = {
				AND = {
					var:dubois_north_american_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_ankylosaurus_var
						has_variable = dubois_diplodocus_var
						has_variable = dubois_triceratops_var
						has_variable = dubois_tyrannosaurus_var
						has_variable = dubois_stegosaurus_var
					}
				}
				AND = {
					var:dubois_south_american_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_antarctosaurus_var
						has_variable = dubois_argyrosaurus_var
					}
				}
				AND = {
					var:dubois_european_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_iguanodon_var
						has_variable = dubois_plateosaurus_var
					}
				}
				AND = {
					var:dubois_african_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_giraffatitan_var
						#has_variable = dubois_melanorosaurus_var
						has_variable = dubois_spinosaurus_var
					}
				}
				AND = {
					var:dubois_asian_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_psittacosaurus_var
						has_variable = dubois_velociraptor_var
					}
				}
				AND = {
					var:dubois_australian_dinosaur_bone >= 5
					NAND = {
						has_variable = dubois_muttaburrasaurus_var
						has_variable = dubois_rhoetosaurus_var
					}
				}
			}
		}
    }
    effect = {
		set_variable = mr_mount_dinosaur_skeleton_button_var
		trigger_event = {
			id = dubois.2171
			popup = yes
		}
    }
}

mr_mount_skeleton_active_sgui = {
    scope = country
    is_shown = {
		OR = {
			has_variable = mr_mount_dinosaur_skeleton_button_var
			var:dubois_paleontologist_var ?= {
				has_variable = mr_paleontologist_is_mounting_dinosaur_var
			}
		}
    }
}

#MR_REMOUNT_SKELETON_BUTTON
mr_remount_skeleton_button = {
    scope = country
    is_valid = {
		custom_tooltip = {
			text = MR_REMOUNT_SKELETON_ACTIVE_BUTTON_TRIGGER
			NOT = { has_variable = mr_remount_dinosaur_skeleton_button_var }
		}
		custom_tooltip = {
			text = MR_REMOUNT_SKELETON_PALEONTOLOGIST_TRIGGER
			trigger_if = {
				limit = {
					has_variable = dubois_paleontologist_var
				}
				var:dubois_paleontologist_var = {
					is_busy = no
					NOT = {
						has_modifier = dubois_exhausted_paleontologist_modifier
					}
				}
			}
			trigger_else = {
				always = no
			}
		}
		custom_tooltip = {
			text = MR_REMOUNT_SKELETON_TRIGGER_TT
			OR = {
				has_variable = dubois_imperfect_ankylosaurus_var
				has_variable = dubois_poor_ankylosaurus_var
				has_variable = dubois_imperfect_diplodocus_var
				has_variable = dubois_poor_diplodocus_var
				has_variable = dubois_imperfect_triceratops_var
				has_variable = dubois_poor_triceratops_var
				has_variable = dubois_imperfect_tyrannosaurus_var
				has_variable = dubois_poor_tyrannosaurus_var
				has_variable = dubois_imperfect_stegosaurus_var
				has_variable = dubois_poor_stegosaurus_var
				has_variable = dubois_imperfect_antarctosaurus_var
				has_variable = dubois_poor_antarctosaurus_var
				has_variable = dubois_imperfect_argyrosaurus_var
				has_variable = dubois_poor_argyrosaurus_var
				has_variable = dubois_imperfect_iguanodon_var
				has_variable = dubois_poor_iguanodon_var
				has_variable = dubois_imperfect_plateosaurus_var
				has_variable = dubois_poor_plateosaurus_var
				has_variable = dubois_imperfect_giraffatitan_var
				has_variable = dubois_poor_giraffatitan_var
				has_variable = dubois_imperfect_spinosaurus_var
				has_variable = dubois_poor_spinosaurus_var
				has_variable = dubois_imperfect_psittacosaurus_var
				has_variable = dubois_poor_psittacosaurus_var
				has_variable = dubois_imperfect_velociraptor_var
				has_variable = dubois_poor_velociraptor_var
				has_variable = dubois_imperfect_muttaburrasaurus_var
				has_variable = dubois_poor_muttaburrasaurus_var
				has_variable = dubois_imperfect_rhoetosaurus_var
				has_variable = dubois_poor_rhoetosaurus_var
			}
		}
    }
    effect = {
		set_variable = mr_remount_dinosaur_skeleton_button_var
		trigger_event = {
			id = dubois.2181
			popup = yes
		}
    }
}

mr_remount_skeleton_active_sgui = {
    scope = country
    is_shown = {
		OR = {
			has_variable = mr_remount_dinosaur_skeleton_button_var
			var:dubois_paleontologist_var ?= {
				has_variable = mr_paleontologist_is_remounting_dinosaur_var
			}
		}
    }
}

#MR_SYSTEMIZE_FOSSILS_BUTTON
mr_systemize_fossils_button = {
    scope = country
    is_valid = {
		custom_tooltip = {
			text = MR_SYSTEMIZE_FOSSILS_BUTTON_TRIGGER
		}
		custom_tooltip = {
			text = MR_ACTIVE_PALEONTOLOGIST_TRIGGER
			has_variable = dubois_paleontologist_var
			var:dubois_paleontologist_var = {
				is_busy = no
			}
		}
    }
    effect = {
		add_journal_entry = {
			type = je_systemize_fossils
		}
		var:dubois_paleontologist_var ?= {
			set_character_busy_and_immortal = yes
		}
    }
}

#MR_SYSTEMIZE_FOSSILS_STOP_BUTTON
mr_systemize_fossils_stop_button = {
    scope = country
	is_shown = {
		has_journal_entry = je_systemize_fossils
	}
    is_valid = {
		NOT = { has_variable = dubois_stop_paleontologist_project_var }
    }
    effect = {
		set_variable = {
			name = dubois_stop_paleontologist_project_var
			days = 7
		}
    }
}

#MR_PREHISTORIC_SCENERY_BUTTONS
#Cretaceous
mr_prehistoric_scenery_cretaceous_button = {
    scope = country
	is_shown = {
		NOT = {
			has_variable = dubois_cretaceous_scenery_var
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_PREHISTORIC_SCENERY_BUTTON_TRIGGER
		}
		custom_tooltip = {
			text = MR_GEOLOGICAL_AGE_1_TRIGGER
			global_var:agassiz_geological_knowledge_global_var > 1
		}
		custom_tooltip = {
			text = MR_ACTIVE_PALEONTOLOGIST_TRIGGER
			has_variable = dubois_paleontologist_var
			var:dubois_paleontologist_var = {
				is_busy = no
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_TRIGGER_TT
			any_scope_building = {
				is_building_type = building_university
				NOR = {
					has_modifier = dubois_cretaceous_scenery_modifier
					has_modifier = dubois_jurassic_scenery_modifier
					has_modifier = dubois_triassic_scenery_modifier
				}
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_ONGOING_TRIGGER_TT
			NOT = {
				has_journal_entry = je_prehistoric_scenery
			}
		}
    }
    effect = {
		add_treasury = -50000
		add_journal_entry = {
			type = je_prehistoric_scenery
		}
		var:dubois_paleontologist_var ?= {
			set_character_busy_and_immortal = yes
		}
    }
}

#Jurassic
mr_prehistoric_scenery_jurassic_button = {
    scope = country
	is_shown = {
		has_variable = dubois_cretaceous_scenery_var
		NOT = {
			has_variable = dubois_jurassic_scenery_var
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_PREHISTORIC_SCENERY_BUTTON_TRIGGER
		}
		custom_tooltip = {
			text = MR_GEOLOGICAL_AGE_5_TRIGGER
			global_var:agassiz_geological_knowledge_global_var > 5
		}
		custom_tooltip = {
			text = MR_ACTIVE_PALEONTOLOGIST_TRIGGER
			has_variable = dubois_paleontologist_var
			var:dubois_paleontologist_var = {
				is_busy = no
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_TRIGGER_TT
			any_scope_building = {
				is_building_type = building_university
				NOR = {
					has_modifier = dubois_cretaceous_scenery_modifier
					has_modifier = dubois_jurassic_scenery_modifier
					has_modifier = dubois_triassic_scenery_modifier
				}
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_ONGOING_TRIGGER_TT
			NOT = {
				has_journal_entry = je_prehistoric_scenery
			}
		}
    }
    effect = {
		add_treasury = -50000
		add_journal_entry = {
			type = je_prehistoric_scenery
		}
		var:dubois_paleontologist_var ?= {
			set_character_busy_and_immortal = yes
		}
    }
}

#Triassic
mr_prehistoric_scenery_triassic_button = {
    scope = country
	is_shown = {
		has_variable = dubois_jurassic_scenery_var
		NOT = {
			has_variable = dubois_triassic_scenery_var
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_PREHISTORIC_SCENERY_BUTTON_TRIGGER
		}
		custom_tooltip = {
			text = MR_GEOLOGICAL_AGE_10_TRIGGER
			global_var:agassiz_geological_knowledge_global_var > 10
		}
		custom_tooltip = {
			text = MR_ACTIVE_PALEONTOLOGIST_TRIGGER
			has_variable = dubois_paleontologist_var
			var:dubois_paleontologist_var = {
				is_busy = no
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_TRIGGER_TT
			any_scope_building = {
				is_building_type = building_university
				NOR = {
					has_modifier = dubois_cretaceous_scenery_modifier
					has_modifier = dubois_jurassic_scenery_modifier
					has_modifier = dubois_triassic_scenery_modifier
				}
			}
		}
		custom_tooltip = {
			text = MR_NO_PREHISTORIC_SCENERY_ONGOING_TRIGGER_TT
			NOT = {
				has_journal_entry = je_prehistoric_scenery
			}
		}
    }
    effect = {
		add_treasury = -50000
		add_journal_entry = {
			type = je_prehistoric_scenery
		}
		var:dubois_paleontologist_var ?= {
			set_character_busy_and_immortal = yes
		}
    }
}

#MR_EXTINCTION_CONGRESS_BUTTON
mr_extinction_congress_button = {
    scope = country
	is_shown = {
		has_global_variable = dubois_hippocampus_congress_hosted_var
		NOT = {
			has_global_variable = dubois_extinction_congress_hosted_var
		}
		NOT = {
			any_country = {
				has_modifier = dubois_congress_host_modifier
			}
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_EXTINCTION_CONGRESS_PALEONTOLOGY_TECH_TRIGGER_TT
			has_technology_researched = dubois_paleontology_tech
		}
		custom_tooltip = {
			text = MR_UNIVERSITY_BUILDING_LEVEL_20_TRIGGER_TT
			country_has_building_type_levels = {  
				target = bt:building_university  
				value  >= 20
			}
		}
		custom_tooltip = {
			text = MR_VISIT_ZOO_BUILDING_TRIGGER_TT
			any_scope_building = {
				is_building_type = building_dubois_zoo
			}
		}
		custom_tooltip = {
			text = MR_HAS_PALEONTOLOGIST_TRIGGER_TT
			dubois_has_paleontologist = yes
		}
		custom_tooltip = {
			text = MR_EXTINCTION_CONGRESS_15_PALEONTOLOGISTS_TRIGGER_TT
			any_country = {
				dubois_has_paleontologist = yes
				count >= 15
			}
		}
		custom_tooltip = {
			text = MR_EXTINCTION_CONGRESS_HAS_DINOSAUR_SKELETON_TRIGGER_TT
			dubois_has_dinosaur_skeleton = yes
		}
		custom_tooltip = {
			text = MR_EXTINCTION_CONGRESS_5_COUNTRIES_DINOSAUR_SKELETON_TRIGGER_TT
			any_country = {
				dubois_has_dinosaur_skeleton = yes
				count >= 5
			}
		}
		custom_tooltip = {
			text = MR_EXTINCTION_CONGRESS_GLOBAL_FOSSIL_TT
			global_var:dubois_global_fossil >= 500
		}
    }
    effect = {
		trigger_event = { 
			id = dubois.921
			popup = yes 
		}
		set_global_variable = dubois_extinction_congress_hosted_var
		add_modifier = {
			name = dubois_congress_host_modifier
			years = 5
		}
    }
}

#MR_PALEONTOLOGICAL_COLECTION_BUTTON
mr_paleontological_collection_button = {
    scope = country
	is_shown = {
		has_technology_researched = dubois_paleontology_tech
		NOT = {
			any_scope_state = {
				is_production_method_active = {
					building_type = building_dubois_zoo
					production_method = pm_paleontological_collection
				}
			}
		}
	}
    is_valid = {
		custom_tooltip = {
			text = MR_HAS_PALEONTOLOGIST_TRIGGER_TT
			dubois_has_paleontologist_no_tooltip_trigger = yes
		}
		custom_tooltip = {
			text = MR_PALEONTOLOGICAL_COLECTION_BUTTON_FOSSILS_TRIGGER_TT
			var:dubois_fossil >= 100
		}
    }
    effect = {
		dubois_add_x_fossils_effect = { AMOUNT = -100 }
		random_scope_state = {
			limit = {
				has_building = building_dubois_zoo
			}
			activate_production_method = {
				building_type = building_dubois_zoo
				production_method = pm_paleontological_collection
			}
		}
    }
}
