##############################
# VERRIER SCRIPTED TRIGGERS  #
##############################

#by Marco Dandolo

############################

### Triggers for Astronomer ###

#Trigger if an unoccupied astronomer exists
verrier_has_active_astronomer = {
	custom_tooltip = {
		text = verrier_has_active_astronomer_tt
		verrier_has_active_astronomer_no_tooltip_trigger = yes
	}
}
verrier_has_active_astronomer_no_tooltip_trigger = {
	has_variable = verrier_astronomer_var
	var:verrier_astronomer_var ?= {
		is_busy = no
	}
}

#Does astronomical observation
verrier_astronomical_observation = {
	any_scope_state = {
		any_scope_building = {
			is_building_type = building_verrier_observatory
			level > 0
		}
	}
}

### Triggers for the rating display ###
verrier_astronomer_fantastic_rating_trigger = {
	verrier_astronomer_character_rating_value > 10
}

verrier_astronomer_very_good_rating_trigger = {
	verrier_astronomer_character_rating_value > 6
}

verrier_astronomer_good_rating_trigger = {
	verrier_astronomer_character_rating_value > 2
}

verrier_astronomer_mediocre_rating_trigger = {
	verrier_astronomer_character_rating_value > 0
}

#####################################################################

### Triggers for Natural Satellites ###

###PRE-GAME SATELLITES### (With Uranus)

#Titania
verrier_can_discover_titania_trigger = {
	has_global_variable = verrier_uranus_discovered_global_var
	NOT = { has_global_variable = verrier_titania_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_early_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Oberon
verrier_can_discover_oberon_trigger = {
	has_global_variable = verrier_uranus_discovered_global_var
	NOT = { has_global_variable = verrier_oberon_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_early_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Enceladus
verrier_can_discover_enceladus_trigger = {
	NOT = { has_global_variable = verrier_enceladus_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_early_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Mimas
verrier_can_discover_mimas_trigger = {
	NOT = { has_global_variable = verrier_mimas_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_early_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

###EARLY-GAME SATELLITES### (With Neptune)

#Triton
verrier_can_discover_triton_trigger = {
	has_global_variable = verrier_neptune_discovered_global_var
	NOT = { has_global_variable = verrier_triton_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Hyperion
verrier_can_discover_hyperion_trigger = {
	has_global_variable = verrier_neptune_discovered_global_var
	NOT = { has_global_variable = verrier_hyperion_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Ariel
verrier_can_discover_ariel_trigger = {
	has_global_variable = verrier_uranus_discovered_global_var
	NOT = { has_global_variable = verrier_ariel_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

#Umbriel
verrier_can_discover_umbriel_trigger = {
	has_global_variable = verrier_uranus_discovered_global_var
	NOT = { has_global_variable = verrier_umbriel_discovered_global_var }
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
}

###MID-GAME SATELLITES (after electromagnetism/camera)

#Deimos
verrier_can_discover_deimos_trigger = {
	NOT = { has_global_variable = verrier_deimos_discovered_global_var }
	has_technology_researched = camera
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Phobos
verrier_can_discover_phobos_trigger = {
	NOT = { has_global_variable = verrier_phobos_discovered_global_var }
	has_technology_researched = camera
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Amalthea
verrier_can_discover_amalthea_trigger = {
	NOT = { has_global_variable = verrier_amalthea_discovered_global_var }
	has_technology_researched = camera
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Phoebe
verrier_can_discover_phoebe_trigger = {
	NOT = { has_global_variable = verrier_phoebe_discovered_global_var }
	has_technology_researched = camera
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_modern_telescope
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_verrier_astro_lab
			}
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

###LATE-GAME SATELLITES (after modern physics)

#Himalia
verrier_can_discover_himalia_trigger = {
	NOT = { has_global_variable = verrier_himalia_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Elara
verrier_can_discover_elara_trigger = {
	NOT = { has_global_variable = verrier_elara_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Pasiphae
verrier_can_discover_pasiphae_trigger = {
	NOT = { has_global_variable = verrier_pasiphae_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

#Sinope
verrier_can_discover_sinope_trigger = {
	NOT = { has_global_variable = verrier_sinope_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
}

###POST-GAME SATELLITES### (after Pluto)

#Lysithea
verrier_can_discover_lysithea_trigger = {
	has_global_variable = verrier_pluto_discovered_var
	NOT = { has_global_variable = verrier_lysithea_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
	var:verrier_astronomer_var = {
		has_trait = verrier_astronomer_famous
	}
}

#Carme
verrier_can_discover_carme_trigger = {
	has_global_variable = verrier_pluto_discovered_var
	NOT = { has_global_variable = verrier_carme_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
	var:verrier_astronomer_var = {
		has_trait = verrier_astronomer_famous
	}
}

#Miranda
verrier_can_discover_miranda_trigger = {
	has_global_variable = verrier_pluto_discovered_var
	has_global_variable = verrier_uranus_discovered_global_var
	NOT = { has_global_variable = verrier_miranda_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
	var:verrier_astronomer_var = {
		has_trait = verrier_astronomer_famous
	}
}

#Nereid
verrier_can_discover_nereid_trigger = {
	has_global_variable = verrier_pluto_discovered_var
	has_global_variable = verrier_neptune_discovered_global_var
	NOT = { has_global_variable = verrier_nereid_discovered_global_var }
	has_technology_researched = camera
	has_technology_researched = verrier_modern_physics_tech
	any_scope_state = {
		is_production_method_active = {
			building_type = building_verrier_observatory
			production_method = pm_verrier_astro_lab
		}
	}
	any_scope_state = {
		OR = {
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_spectroscopy
			}
			is_production_method_active = {
				building_type = building_verrier_observatory
				production_method = pm_mendelejew_cyclotron
			}
		}
	}
	var:verrier_astronomer_var = {
		has_trait = verrier_astronomer_famous
	}
}

### Satellite Triggers by Planet ###

#Mars
verrier_can_discover_mars_satellite_trigger = {
	OR = {
		verrier_can_discover_deimos_trigger = yes
		verrier_can_discover_phobos_trigger = yes
	}
}

#Jupiter
verrier_can_discover_jupiter_satellite_trigger = {
	OR = {
		verrier_can_discover_amalthea_trigger = yes
		verrier_can_discover_himalia_trigger = yes
		verrier_can_discover_elara_trigger = yes
		verrier_can_discover_pasiphae_trigger = yes
		verrier_can_discover_sinope_trigger = yes
		verrier_can_discover_lysithea_trigger = yes
		verrier_can_discover_carme_trigger = yes
	}
}

#Saturn
verrier_can_discover_saturn_satellite_trigger = {
	OR = {
		verrier_can_discover_enceladus_trigger = yes
		verrier_can_discover_mimas_trigger = yes
		verrier_can_discover_hyperion_trigger = yes
		verrier_can_discover_phoebe_trigger = yes
	}
}

#Uranus
verrier_can_discover_uranus_satellite_trigger = {
	OR = {
		verrier_can_discover_titania_trigger = yes
		verrier_can_discover_oberon_trigger = yes
		verrier_can_discover_ariel_trigger = yes
		verrier_can_discover_umbriel_trigger = yes
		verrier_can_discover_miranda_trigger = yes
	}
}

#Neptune
verrier_can_discover_neptune_satellite_trigger = {
	OR = {
		verrier_can_discover_triton_trigger = yes
		verrier_can_discover_nereid_trigger = yes
	}
}

### General Trigger for Satellites ###

verrier_can_discover_satellite_trigger = {
	OR = {
		verrier_can_discover_mars_satellite_trigger = yes
		verrier_can_discover_jupter_satellite_trigger = yes
		verrier_can_discover_saturn_satellite_trigger = yes
		verrier_can_discover_uranus_satellite_trigger = yes
		verrier_can_discover_neptune_satellite_trigger = yes
	}
}