###################
# AGASSIZ EVENTS  #
###################

#by Marco Dandolo

###################

namespace = agassiz

###################

#################################################################################

#Agassiz 1: Yearly minerals
agassiz.1 = {
	dlc = dlc_morgenrote

	type = country_event
		
	hidden = yes

	trigger = {
		NOT = {
			has_variable = agassiz_mineral_cooldown_var
		}
		has_technology_researched = agassiz_geology_tech
	}

	immediate = {
		set_variable = {
			name = agassiz_mineral_cooldown_var
			days = 365
		}

		agassiz_add_x_generic_minerals_effect = {
			AMOUNT = agassiz_yearly_mineral_value
		}

		if = {
			limit = {
				has_variable = agassiz_yearly_generic_minerals_var
			}
			set_variable = {
				name = agassiz_generic_minerals_notification_var
				value = var:agassiz_yearly_generic_minerals_var
			}
			set_variable = {
				name = agassiz_yearly_generic_minerals_var
				value = 0
			}
		}
		post_notification = agassiz_yearly_minerals_notification
	}
}

#################################################################################

#Agassiz 100: Searching new ore veins
agassiz.100 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.100.t

	desc = agassiz.100.d

	flavor = agassiz.100.f
	
	duration = 3

	event_image = {
		video = "europenorthamerica_gold_prospectors"
	}

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
	}

	option = {	#Coal
		name = agassiz.100.h
		trigger = { agassiz_can_find_coal_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_coal_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_small
		}
	}

	option = {	#Iron
		name = agassiz.100.i
		trigger = { agassiz_can_find_iron_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_iron_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_small
		}
	}

	option = {	#Lead
		name = agassiz.100.j
		trigger = { agassiz_can_find_lead_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_lead_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_very_small
		}
	}

	option = {	#Sulfur
		name = agassiz.100.k
		trigger = { agassiz_can_find_sulfur_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_sulfur_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_very_small
		}
	}

	option = {	#Gold
		name = agassiz.100.l
		trigger = { agassiz_can_find_gold_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_gold_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_medium
		}
	}

	option = {	#Uranium
		name = agassiz.100.m
		trigger = { agassiz_can_find_uranium_vein_trigger = yes }
		add_journal_entry = { type = je_agassiz_find_uranium_project }
		add_modifier = {
			name = agassiz_ore_search_cost_modifier
			multiplier = money_amount_multiplier_medium
		}
	}

	option = {	#None of them
		name = agassiz.100.g
		trigger = { is_ai = no }
		default_option = yes
		var:dubois_geologist_var = {
			set_character_busy_and_immortal = no
		}
	}

	after = {
		remove_variable = agassiz_decide_ore_vein_var
	}
}

#Agassiz 101: New ore vein
agassiz.101 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.101.t

	desc = agassiz.101.d

	flavor = agassiz.101.f
	
	duration = 3

	event_image = {
		video = "europenorthamerica_gold_prospectors"
	}

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
	}

	option = {	#Good
		name = agassiz.101.g
		geologist_experience_gain_effect = { AMOUNT = 10 }
		agassiz_add_x_generic_minerals_effect = { AMOUNT = 2500 }
		random_list = {
			1 = {
				if = {
					limit = {
						NOT = {
							var:dubois_geologist_var = {
								has_trait = agassiz_prospector
							}
						}
					}
					var:dubois_geologist_var = {
						add_trait = agassiz_prospector
					}
				}
			}
			1 = {}
		}
	}

	after = {
		remove_variable = agassiz_building_geologist_improvement_var
	}
}

#Agassiz 102: Oil!
agassiz.102 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.102.t

	desc = agassiz.102.d

	flavor = agassiz.102.f
	
	duration = 3

	event_image = {
		video = "middleeast_oil_derricks"
	}

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
	}

	option = {	#Good
		name = agassiz.102.g
		geologist_experience_gain_effect = { AMOUNT = 15 }
		random_list = {
			1 = {
				if = {
					limit = {
						NOT = {
							var:dubois_geologist_var = {
								has_trait = agassiz_prospector
							}
						}
					}
					var:dubois_geologist_var = {
						add_trait = agassiz_prospector
					}
				}
			}
			1 = {}
		}
	}

	after = {
		remove_variable = agassiz_building_geologist_improvement_var
	}
}

#################################################################################

#Agassiz 201: Mid Atlantic Ridge
agassiz.201 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.201.t

	desc = agassiz.201.d

	flavor = agassiz.201.f
	
	duration = 3

	event_image = {
		texture = "gfx/event_pictures/gaudi_pictures/gaudi_engineering_electrical_transatlantic_cable.dds"
	}

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
		set_variable = dubois_mid_atlantic_ridge_examined_var
		remove_modifier = agassiz_mid_atlantic_ridge_cost_modifier
	}

	option = {	#This will improve the geologist's geophysical understanding.
		name = agassiz.201.g
		trigger = {
			NOT = {
				var:dubois_geologist_var = {
					has_trait = agassiz_geophysicist
				}
			}
		}
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
		rapanui_add_x_oceanographic_understanding_effect = { AMOUNT = 5 }
		if = {
			limit = {
				NOT = {
					var:dubois_geologist_var = {
						has_trait = agassiz_geophysicist
					}
				}
			}
			var:dubois_geologist_var = {
				add_trait = agassiz_geophysicist
			}
		}
	}

	option = {	#This will improve the geologist's oceanographic understanding.
		name = agassiz.201.h
		trigger = {
			NOT = {
				var:dubois_geologist_var = {
					has_trait = agassiz_oceanographer
				}
			}
		}
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
		rapanui_add_x_oceanographic_understanding_effect = { AMOUNT = 5 }
		if = {
			limit = {
				NOT = {
					var:dubois_geologist_var = {
						has_trait = agassiz_oceanographer
					}
				}
			}
			var:dubois_geologist_var = {
				add_trait = agassiz_oceanographer
			}
		}
	}

	option = {	#This will improve the geologist's general understanding.
		name = agassiz.201.i
		default_option = yes
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
		rapanui_add_x_oceanographic_understanding_effect = { AMOUNT = 5 }
		geologist_experience_gain_effect = { AMOUNT = 30 }
	}

	after = {
	}
}

#Agassiz 202: Geological-Paleontological Symposium
agassiz.202 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.202.t

	desc = agassiz.202.d

	flavor = agassiz.202.f
	
	duration = 3

	gui_window = event_window_2char

	left_icon = scope:dubois_geologist_scope
	right_icon = scope:dubois_paleontologist_scope

	icon = "gfx/interface/icons/event_icons/event_navigation.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
		var:dubois_geologist_var = {
			save_scope_as = dubois_geologist_scope
		}
		var:dubois_paleontologist_var = {
			save_scope_as = dubois_paleontologist_scope
		}
	}

	option = {	#A fruitful academic exchange
		name = agassiz.202.g
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
		dubois_add_x_academy_progress = { AMOUNT = 25 }
		dubois_medium_add_technology = yes
	}

	after = {
	}
}

#################################################################################

#Agassiz 301: Geological research completed
agassiz.301 = {
	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.301.t

	desc = agassiz.301.d

	flavor = agassiz.301.f
	
	duration = 3

	gui_window = event_window_1char_tabloid

	left_icon = scope:agassiz_geologist_scope

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	trigger = {
	}

	immediate = {
		var:dubois_geologist_var = {
			save_scope_as = agassiz_geologist_scope
		}
	}

	option = {	#Minerals are exactly his thing, right?
		name = agassiz.301.g
		geologist_experience_gain_effect = { AMOUNT = 10 }
		agassiz_add_x_rare_minerals_effect = { AMOUNT = 1 }
		agassiz_add_x_generic_minerals_effect = { AMOUNT = 25000 }
		if = {
			limit = {
				NOT = {
					var:dubois_geologist_var = {
						has_trait = agassiz_mineralogist
					}
				}
			}
			var:dubois_geologist_var = {
				add_trait = agassiz_mineralogist
			}
		}
	}

	after = {
	}
}

#Agassiz 311: Meteorite
agassiz.311 = { 

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.311.t
	desc = agassiz.311.d
	flavor = agassiz.311.f

	duration = 3 

	event_image = {
		texture = "gfx/event_pictures/verrier_pictures/verrier_meteorids.dds"  
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_astronomy.dds"

	cooldown = {
		years = 10
	}

	trigger = {
		has_variable = dubois_geologist_var
		has_variable = verrier_astronomer_var
		has_technology_researched = verrier_modern_physics_tech
		OR = {
			agassiz_has_terrain_arctic = yes
			agassiz_has_terrain_desert = yes
		}
	}
		
	option = { #Where in space does it come from?
		name = agassiz.311.g
		verrier_small_add_technology = yes
		verrier_add_x_meteorites_effect = {
			AMOUNT = 1
		}
	}

	after = {
		if = {
			limit = {
				mendelejew_has_chemist = yes
				var:verrier_meteorites_var >= 1
				OR = {
					has_journal_entry = je_mendelejew_element_theory
					has_journal_entry = je_mendelejew_element_discovery
					has_journal_entry = je_mendelejew_element_isolation
					has_journal_entry = je_mendelejew_synthetic_oil
					has_journal_entry = je_mendelejew_synthetic_rubber
				}
			}
			trigger_event = {
				id = verrier.422
				days = { 7 21 }
			}
		}
	}
}

#Agassiz 312: Geological Survey
agassiz.312 = { 

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.312.t
	desc = agassiz.312.d
	flavor = agassiz.312.f

	duration = 3 

	event_image = {
		texture = "gfx/event_pictures/agassiz_pictures/agassiz_chart.dds"  
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	cooldown = {
		years = 10
	}

	trigger = {
	}
		
	option = { #Use the knowledge theoretically.
		name = agassiz.312.g
		dubois_medium_add_technology = yes
	}

	option = { #Use the knowledge practically.
		name = agassiz.312.h
		agassiz_add_x_generic_minerals_effect = { AMOUNT = 10000 }
		dubois_add_x_academy_progress = { AMOUNT = 10 }
		geologist_experience_gain_effect = { AMOUNT = 10 }
	}
}

#Agassiz 313: Mineral Deposits
agassiz.313 = { 

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.313.t
	desc = agassiz.313.d
	flavor = agassiz.313.f

	duration = 3 

	event_image = {
		texture = "gfx/event_pictures/agassiz_pictures/agassiz_minerals.dds"  
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	cooldown = {
		years = 10
	}

	trigger = {
	}
		
	option = { #Quantity
		name = agassiz.313.g
		agassiz_add_x_generic_minerals_effect = { AMOUNT = 15000 }
	}

	option = { #Quality
		name = agassiz.313.h
		agassiz_add_x_rare_minerals_effect = { AMOUNT = 1 }
	}
}

#Agassiz 314: Inspiring Geologist
agassiz.314 = { 

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.314.t
	desc = agassiz.314.d
	flavor = agassiz.314.f

	duration = 3 

	event_image = {
		texture = "gfx/event_pictures/agassiz_pictures/agassiz_minerals.dds"  
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	cooldown = {
		years = 10
	}

	trigger = {
	}
		
	option = { #This will boost his reputation.
		name = agassiz.313.g
		geologist_experience_gain_effect = { AMOUNT = 10 }
	}

	option = { #This will boost the reputation of his university.
		name = agassiz.313.h
		dubois_add_x_academy_progress = { AMOUNT = 10 }
	}
}

#Agassiz 315: Geological Insights
agassiz.315 = { 

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.315.t
	desc = agassiz.315.d
	flavor = agassiz.315.f

	duration = 3 

	event_image = {
		texture = "gfx/event_pictures/agassiz_pictures/agassiz_chart.dds"  
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	cooldown = {
		years = 20
	}

	trigger = {
	}
		
	option = { #Excellent
		name = agassiz.315.g
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
	}
}

#################################################################################

#Agassiz 401: Age of Earth Calculations
agassiz.401 = {

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.401.t
	desc = agassiz.401.d
	flavor = agassiz.401.f

	duration = 3 

	gui_window = event_window_1char_tabloid

	left_icon = scope:agassiz_geologist_scope

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	trigger = {
	}

	immediate = {
		var:dubois_geologist_var = {
			save_scope_as = agassiz_geologist_scope
		}
		set_global_variable = {
			name = agassiz_age_of_earth_yes_global_var
			value = 0
		}
		set_global_variable = {
			name = agassiz_age_of_earth_no_global_var
			value = 0
		}
	}
		
	option = { #Send the paper to all well-known geologists worldwide.
		name = agassiz.401.g
		dubois_small_add_technology = yes
		change_global_variable = {
			name = agassiz_age_of_earth_yes_global_var
			add = 1
		}
		custom_tooltip = agassiz.401.tt
		hidden_effect = {
			every_country = {
				limit = {
					has_variable = dubois_geologist_var
					NOT = {
						this = ROOT
					}
				}
				trigger_event = {
					id = agassiz.402
					days = { 14 28 }
				}
			}
		}
	}
	
	after = {
		trigger_event = {
			id = agassiz.403
			days = { 90 120 }
		}
	}
	
}

#Agassiz 402: Age of Earth Calculations - other nations
agassiz.402 = {

	dlc = dlc_morgenrote

	type = country_event

	title = agassiz.402.t
	desc = agassiz.402.d
	flavor = agassiz.401.f

	duration = 3 

	gui_window = event_window_1char_tabloid

	left_icon = scope:agassiz_geologist_scope

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	trigger = {
	}
		
	option = { #These calculations are convincing.
		name = agassiz.402.g
		default_option = yes
		change_global_variable = {
			name = agassiz_age_of_earth_yes_global_var
			add = 1
		}
		ai_chance = {
			base = 60
			modifier = { #Will be more interested to accept new age when no new age was estimated in the last 10 years
				trigger = {
					NOT = {
						has_global_variable = agassiz_age_of_earth_recent_calculation_global_var
					}
				}
				add = 20
			}
			modifier = { #Experienced Geologist
				trigger = {
					scope:dubois_geologist_scope = {
						var:dubois_geologist_experience >= 200
					}
				}
				add = 10
			}
			modifier = { #Geologist is Geophisicist
				trigger = {
					scope:dubois_geologist_scope = {
						has_trait = agassiz_geophysicist
					}
				}
				add = 10
			}
			modifier = { #Geologist has another specialization
				trigger = {
					scope:dubois_geologist_scope = {
						OR = {
							has_trait = agassiz_volcanologist
							has_trait = agassiz_mineralogist
							has_trait = agassiz_prospector
							has_trait = agassiz_oceanographer
						}
					}
				}
				add = 5
			}
			modifier = { #Geologist has another positive trait
				trigger = {
					scope:dubois_geologist_scope = {
						OR = {
							has_trait = erudite
							has_trait = innovative
							has_trait = meticulous
							has_trait = charismatic
						}
					}
				}
				add = 5
			}
			modifier = { #Geologist has respected age
				trigger = {
					scope:dubois_geologist_scope = {
						age >= 50
					}
				}
				add = 5
			}
		}
	}

	option = { #Who is supposed to believe this pseudo-geological nonsense?
		name = agassiz.402.h
		change_global_variable = {
			name = agassiz_age_of_earth_no_global_var
			add = 1
		}
		ai_chance = {
			base = 40
			modifier = { #Unexperienced Geologist
				trigger = {
					scope:dubois_geologist_scope = {
						var:dubois_geologist_experience < 200
					}
				}
				add = 10
			}
			modifier = { #Geologist does not have any specialization
				trigger = {
					scope:dubois_geologist_scope = {
						OR = {
							has_trait = agassiz_volcanologist
							has_trait = agassiz_mineralogist
							has_trait = agassiz_prospector
							has_trait = agassiz_oceanographer
							has_trait = agassiz_geophysicist
						}
					}
				}
				add = 5
			}
			modifier = { #Geologist has a negative trait
				trigger = {
					scope:dubois_geologist_scope = {
						OR = {
							has_trait = arrogant
							has_trait = bigoted
							has_trait = cruel
							has_trait = wrathful
						}
					}
				}
				add = 5
			}
			modifier = { #Geologist is young
				trigger = {
					scope:dubois_geologist_scope = {
						age < 35
					}
				}
				add = 5
			}
		}
	}
}

#Agassiz 403: Success/Failure
agassiz.403 = {

	dlc = dlc_morgenrote

	type = country_event

	title = {
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var >= global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.t_yes
		}
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var < global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.t_no
		}
	}
	desc = {
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var >= global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.d_yes
		}
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var < global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.d_no
		}
	}
	flavor = {
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var >= global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.f_yes
		}
		triggered_desc = {
			trigger = {
				global_var:agassiz_age_of_earth_yes_global_var < global_var:agassiz_age_of_earth_no_global_var
			}
			desc = agassiz.403.f_no
		}
	}

	duration = 3 

	gui_window = event_window_1char_tabloid

	left_icon = scope:agassiz_geologist_scope

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_geology.dds"

	trigger = {
	}

	immediate = {
		var:dubois_geologist_var = {
			save_scope_as = agassiz_geologist_scope
		}
	}
		
	option = { #Success!
		name = agassiz.403.g
		default_option = yes
		trigger = {
			global_var:agassiz_age_of_earth_yes_global_var >= global_var:agassiz_age_of_earth_no_global_var
		}
		var:dubois_geologist_var = {
			set_variable = agassiz_geologist_calculated_age_earth_var
		}
		agassiz_set_new_age_of_earth_effect = yes
		agassiz_add_x_geological_knowledge_effect = { AMOUNT = 1 }
		dubois_add_x_academy_progress = { AMOUNT = 10 }
		geologist_experience_gain_effect = { AMOUNT = 30 }
		dubois_small_add_technology = yes
		set_global_variable = {
			name = agassiz_age_of_earth_recent_calculation_global_var
			years = 10
		}
		every_country = {
			limit = {
				is_player = yes
			}
			post_notification = agassiz_new_earth_age_notification
		}
	}

	option = { #Fail ...
		name = agassiz.403.h
		trigger = {
			global_var:agassiz_age_of_earth_yes_global_var < global_var:agassiz_age_of_earth_no_global_var
		}
		add_modifier = {
			name = agassiz_geologist_demotivated_modifier
			years = 5
		}
	}

	after = {
		remove_global_variable = agassiz_age_of_earth_yes_global_var
		remove_global_variable = agassiz_age_of_earth_no_global_var
		remove_global_variable = agassiz_age_of_earth_debate_global_var
	}
}